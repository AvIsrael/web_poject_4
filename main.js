!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._inputList=this._formElement.querySelectorAll(this._inputSelector),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_hideValidationMessage(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._inputList.forEach((e=>{this._hideInputError(e)}))}resetWholeForm(){this._hideValidationMessage(),this._toggleButtonState(),this._formElement.reset()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s,n,o){t(this,"_handleDeleteButton",(()=>{this._element.remove(),this._element=null})),t(this,"_handleLikeButton",(()=>{this._element.querySelector(".elements__button-heart").classList.toggle("elements__button-heart_active")})),this._name=e,this._link=s,this._cardSelector=n,this._handleCardClick=o}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".elements__item").cloneNode(!0)}_setEventListeners(){this._element.querySelector(".elements__button-delete").addEventListener("click",this._handleDeleteButton),this._element.querySelector(".elements__button-heart").addEventListener("click",this._handleLikeButton),this._element.querySelector(".elements__grid-image").addEventListener("click",(()=>this._handleCardClick({name:this._name,src:this._link})))}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".elements__grid-image"),t=this._element.querySelector(".elements__description");return e.src=this._link,e.alt="Photo of ".concat(this._name),t.textContent=this._name,this._element}}const n={formSelector:".popup__form",inputSelector:".popup__item",submitButtonSelector:".popup__button-sbmt",inactiveButtonClass:"popup__button-sbmt_disabled",inputErrorClass:"popup__item_type_error",errorClass:"popup__error_visible"};class o{constructor(e){var t,s;s=e=>{"Escape"===e.key&&this.close()},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__button"))&&this.close()}))}}class i extends o{constructor(e,t){super(e),this._handleFormSubmit=t,this._popupForm=this._popupElement.querySelector(".popup__form"),this._inputs=Array.from(this._popupForm.querySelectorAll(".popup__item"))}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}close(){super.close(),this._popupForm.reset()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>this._handleFormSubmit(this._getInputValues())))}}const r=document.querySelector(".profile__button-unusual"),l=document.querySelector(".profile__button"),a=document.getElementById("formElementEdit"),u=document.getElementById("formElementAdd"),c=document.getElementById("name"),_=document.getElementById("about"),m=new class{constructor(e){let{userNameSelector:t,userJobSelector:s}=e;this._userNameElement=document.querySelector(t),this._userJobElement=document.querySelector(s)}getUserInfo(){return{name:this._userNameElement.textContent,job:this._userJobElement.textContent}}setUserInfo(e){let{name:t,job:s}=e;this._userNameElement.textContent=t,this._userJobElement.textContent=s}}({userNameSelector:".profile__hero",userJobSelector:".profile__role"}),p=new i("#popup-edit",(function(e){m.setUserInfo(e),p.close()})),h=new i("#popup-add",(function(e){v.addItem(e.title,e["image-link"]),h.close()})),d=new class extends o{constructor(e){super(e),this._imageZoom=this._popupElement.querySelector(".popup__viewer-image"),this._imageZoomTitle=this._popupElement.querySelector(".popup__viewer-text")}open(e,t){super.open(),this._imageZoom.src=t,this._imageZoom.alt="Photo of ".concat(e),this._imageZoomTitle.textContent=e}}("#popup-viewer");p.setEventListeners(),h.setEventListeners(),d.setEventListeners(),r.addEventListener("click",(function(){p.open();const{name:e,job:t}=m.getUserInfo();b.resetWholeForm(),c.value=e,_.value=t}));const E=new e(n,u);E.enableValidation();const b=new e(n,a);b.enableValidation(),l.addEventListener("click",(function(){h.open(),E.resetWholeForm()}));const v=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}addItem(e,t){const s=this._renderer(e,t);this._container.prepend(s)}renderItems(){this._items.forEach((e=>{this.addItem(e.name,e.link)}))}}({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:(e,t)=>new s(e,t,"#card",(()=>d.open(e,t))).generateCard()},".elements__items");v.renderItems()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDakJDLFlBQVlDLEVBQW1CQyxHQUMzQkMsS0FBS0MsZUFBaUJILEVBQWtCSSxjQUN4Q0YsS0FBS0csc0JBQXdCTCxFQUFrQk0scUJBQy9DSixLQUFLSyxxQkFBdUJQLEVBQWtCUSxvQkFDOUNOLEtBQUtPLGlCQUFtQlQsRUFBa0JVLGdCQUMxQ1IsS0FBS1MsWUFBY1gsRUFBa0JZLFdBQ3JDVixLQUFLVyxhQUFlWixFQUd4QmEsZ0JBQWdCQyxHQUNaLE1BQU1DLEVBQWVkLEtBQUtXLGFBQWFJLGNBQWxCLFdBQW9DRixFQUFhRyxHQUFqRCxXQUNyQkgsRUFBYUksVUFBVUMsSUFBSWxCLEtBQUtPLGtCQUNoQ08sRUFBYUssWUFBY04sRUFBYU8sa0JBQ3hDTixFQUFhRyxVQUFVQyxJQUFJbEIsS0FBS1MsYUFHcENZLGdCQUFnQlIsR0FDWixNQUFNQyxFQUFlZCxLQUFLVyxhQUFhSSxjQUFsQixXQUFvQ0YsRUFBYUcsR0FBakQsV0FDckJILEVBQWFJLFVBQVVLLE9BQU90QixLQUFLTyxrQkFDbkNPLEVBQWFHLFVBQVVLLE9BQU90QixLQUFLUyxhQUNuQ0ssRUFBYUssWUFBYyxHQUcvQkksb0JBQW9CVixHQUNYQSxFQUFhVyxTQUFTQyxNQUd2QnpCLEtBQUtxQixnQkFBZ0JSLEdBRnJCYixLQUFLWSxnQkFBZ0JDLEdBTTdCYSxtQkFDSSxPQUFPMUIsS0FBSzJCLFdBQVdDLE1BQU1mLElBQWtCQSxFQUFhVyxTQUFTQyxRQUd6RUkscUJBQ1E3QixLQUFLMEIsb0JBQ0wxQixLQUFLOEIsZUFBZWIsVUFBVUMsSUFBSWxCLEtBQUtLLHNCQUN2Q0wsS0FBSzhCLGVBQWVDLFVBQVcsSUFFL0IvQixLQUFLOEIsZUFBZWIsVUFBVUssT0FBT3RCLEtBQUtLLHNCQUMxQ0wsS0FBSzhCLGVBQWVDLFVBQVcsR0FJdkNDLHFCQUNJaEMsS0FBSzJCLFdBQWEzQixLQUFLVyxhQUFhc0IsaUJBQWlCakMsS0FBS0MsZ0JBQzFERCxLQUFLOEIsZUFBaUI5QixLQUFLVyxhQUFhSSxjQUFjZixLQUFLRyx1QkFDM0RILEtBQUsyQixXQUFXTyxTQUFTckIsSUFDckJBLEVBQWFzQixpQkFBaUIsU0FBUyxLQUNuQ25DLEtBQUt1QixvQkFBb0JWLEdBQ3pCYixLQUFLNkIsMkJBS2pCTyx5QkFDSXBDLEtBQUsyQixXQUFhVSxNQUFNQyxLQUNwQnRDLEtBQUtXLGFBQWFzQixpQkFBaUJqQyxLQUFLQyxpQkFFNUNELEtBQUsyQixXQUFXTyxTQUFTckIsSUFDckJiLEtBQUtxQixnQkFBZ0JSLE1BSTdCMEIsaUJBQ0l2QyxLQUFLb0MseUJBQ0xwQyxLQUFLNkIscUJBQ0w3QixLQUFLVyxhQUFhNkIsUUFHdEJDLG1CQUNJekMsS0FBS1csYUFBYXdCLGlCQUFpQixVQUFXTyxJQUMxQ0EsRUFBSUMsb0JBRVIzQyxLQUFLZ0Msc0Isd0hDNUVFLE1BQU1ZLEVBQ2pCL0MsWUFBWWdELEVBQU1DLEVBQU1DLEVBQWNDLEdBQWlCLDhCQTRCakMsS0FDbEJoRCxLQUFLaUQsU0FBUzNCLFNBQ2R0QixLQUFLaUQsU0FBVyxRQTlCbUMsNEJBaUNuQyxLQUNoQmpELEtBQUtpRCxTQUNBbEMsY0FBYywyQkFDZEUsVUFBVWlDLE9BQU8sb0NBbkN0QmxELEtBQUttRCxNQUFRTixFQUNiN0MsS0FBS29ELE1BQVFOLEVBQ2I5QyxLQUFLcUQsY0FBZ0JOLEVBQ3JCL0MsS0FBS3NELGlCQUFtQk4sRUFHNUJPLGVBS0ksT0FKb0JDLFNBQ2Z6QyxjQUFjZixLQUFLcUQsZUFDbkJJLFFBQVExQyxjQUFjLG1CQUN0QjJDLFdBQVUsR0FJbkIxQixxQkFDeUJoQyxLQUFLaUQsU0FBU2xDLGNBQWMsNEJBQ3BDb0IsaUJBQWlCLFFBQVNuQyxLQUFLMkQscUJBRXhCM0QsS0FBS2lELFNBQVNsQyxjQUFjLDJCQUNwQ29CLGlCQUFpQixRQUFTbkMsS0FBSzRELG1CQUV6QjVELEtBQUtpRCxTQUFTbEMsY0FBYyx5QkFDcENvQixpQkFBaUIsU0FBUyxJQUNoQ25DLEtBQUtzRCxpQkFBaUIsQ0FBQ1QsS0FBTTdDLEtBQUttRCxNQUFPVSxJQUFLN0QsS0FBS29ELFVBZTNEVSxlQUNJOUQsS0FBS2lELFNBQVdqRCxLQUFLdUQsZUFDckJ2RCxLQUFLZ0MscUJBQ0wsTUFBTStCLEVBQVkvRCxLQUFLaUQsU0FBU2xDLGNBQWMseUJBQ3hDaUQsRUFBV2hFLEtBQUtpRCxTQUFTbEMsY0FBYywwQkFJN0MsT0FIQWdELEVBQVVGLElBQU03RCxLQUFLb0QsTUFDckJXLEVBQVVFLElBQVYsbUJBQTRCakUsS0FBS21ELE9BQ2pDYSxFQUFTN0MsWUFBY25CLEtBQUttRCxNQUNyQm5ELEtBQUtpRCxVQ2hEYixNQUFNbkQsRUFBb0IsQ0FDN0JvRSxhQUFjLGVBQ2RoRSxjQUFlLGVBQ2ZFLHFCQUFzQixzQkFDdEJFLG9CQUFxQiw4QkFDckJFLGdCQUFpQix5QkFDakJFLFdBQVksd0JDTkQsTUFBTXlELEVBQ2pCdEUsWUFBWXVFLEcsVUFjTzFCLElBQ0MsV0FBWkEsRUFBSTJCLEtBQ0pyRSxLQUFLc0UsVSxFQWhCWSwwQixzQkFBQSxLLHVEQUFBLEssS0FDckJ0RSxLQUFLdUUsY0FBZ0JmLFNBQVN6QyxjQUFjcUQsR0FHaERJLE9BQ0l4RSxLQUFLdUUsY0FBY3RELFVBQVVDLElBQUksZ0JBQ2pDc0MsU0FBU3JCLGlCQUFpQixVQUFXbkMsS0FBS3lFLGlCQUc5Q0gsUUFDSXRFLEtBQUt1RSxjQUFjdEQsVUFBVUssT0FBTyxnQkFDcENrQyxTQUFTa0Isb0JBQW9CLFVBQVcxRSxLQUFLeUUsaUJBU2pERSxvQkFDSTNFLEtBQUt1RSxjQUFjcEMsaUJBQWlCLGFBQWNPLEtBRTFDQSxFQUFJa0MsT0FBTzNELFVBQVU0RCxTQUFTLGlCQUM5Qm5DLEVBQUlrQyxPQUFPM0QsVUFBVTRELFNBQVMsbUJBRTlCN0UsS0FBS3NFLFlDekJOLE1BQU1RLFVBQXNCWCxFQUN2Q3RFLFlBQVl1RSxFQUFhVyxHQUNyQkMsTUFBTVosR0FDTnBFLEtBQUtpRixrQkFBb0JGLEVBQ3pCL0UsS0FBS2tGLFdBQWFsRixLQUFLdUUsY0FBY3hELGNBQWMsZ0JBQ25EZixLQUFLbUYsUUFBVTlDLE1BQU1DLEtBQ2pCdEMsS0FBS2tGLFdBQVdqRCxpQkFBaUIsaUJBSXpDbUQsa0JBQ0ksTUFBTUMsRUFBYyxHQUlwQixPQUhBckYsS0FBS21GLFFBQVFqRCxTQUFTb0QsSUFDbEJELEVBQVlDLEVBQU16QyxNQUFReUMsRUFBTUMsU0FFN0JGLEVBR1hmLFFBQ0lVLE1BQU1WLFFBQ050RSxLQUFLa0YsV0FBVzFDLFFBR3BCbUMsb0JBQ0lLLE1BQU1MLG9CQUNOM0UsS0FBS2tGLFdBQVcvQyxpQkFBaUIsVUFBVSxJQUN2Q25DLEtBQUtpRixrQkFBa0JqRixLQUFLb0Ysc0JDaEJ4QyxNQUFNSSxFQUFhaEMsU0FBU3pDLGNBQWMsNEJBQ3BDMEUsRUFBWWpDLFNBQVN6QyxjQUFjLG9CQUNuQzJFLEVBQWtCbEMsU0FBU21DLGVBQWUsbUJBQzFDQyxFQUFpQnBDLFNBQVNtQyxlQUFlLGtCQUN6Q0UsRUFBWXJDLFNBQVNtQyxlQUFlLFFBQ3BDRyxFQUFXdEMsU0FBU21DLGVBQWUsU0FFbkNJLEVBQVcsSUNuQkYsTUFDWGxHLFlBQVksR0FBcUMsSUFBckMsaUJBQUNtRyxFQUFELGdCQUFtQkMsR0FBa0IsRUFDN0NqRyxLQUFLa0csaUJBQW1CMUMsU0FBU3pDLGNBQWNpRixHQUMvQ2hHLEtBQUttRyxnQkFBa0IzQyxTQUFTekMsY0FBY2tGLEdBR2xERyxjQUNJLE1BQU8sQ0FDSHZELEtBQU03QyxLQUFLa0csaUJBQWlCL0UsWUFDNUJrRixJQUFLckcsS0FBS21HLGdCQUFnQmhGLGFBSWxDbUYsWUFBWSxHQUFhLElBQWIsS0FBQ3pELEVBQUQsSUFBT3dELEdBQU0sRUFDckJyRyxLQUFLa0csaUJBQWlCL0UsWUFBYzBCLEVBQ3BDN0MsS0FBS21HLGdCQUFnQmhGLFlBQWNrRixJREliLENBQzFCTCxpQkFBa0IsaUJBQ2xCQyxnQkFBaUIsbUJBR2ZNLEVBQVksSUFBSXpCLEVBQ2xCLGVBaUJKLFNBQWlDMEIsR0FDN0JULEVBQVNPLFlBQVlFLEdBQ3JCRCxFQUFVakMsV0FmUm1DLEVBQWUsSUFBSTNCLEVBQ3JCLGNBb0NKLFNBQWlDNEIsR0FDN0JDLEVBQVNDLFFBQVFGLEVBQVdHLE1BQU9ILEVBQVcsZUFDOUNELEVBQWFuQyxXQWxDWHdDLEVBQWEsSUVoQ0osY0FBNkIzQyxFQUN4Q3RFLFlBQVl1RSxHQUNSWSxNQUFNWixHQUNOcEUsS0FBSytHLFdBQWEvRyxLQUFLdUUsY0FBY3hELGNBQWMsd0JBQ25EZixLQUFLZ0gsZ0JBQWtCaEgsS0FBS3VFLGNBQWN4RCxjQUFjLHVCQUc1RHlELEtBQUszQixFQUFNQyxHQUNQa0MsTUFBTVIsT0FDTnhFLEtBQUsrRyxXQUFXbEQsSUFBTWYsRUFDdEI5QyxLQUFLK0csV0FBVzlDLElBQWhCLG1CQUFrQ3BCLEdBQ2xDN0MsS0FBS2dILGdCQUFnQjdGLFlBQWMwQixJRnFCTCxpQkFFdEMwRCxFQUFVNUIsb0JBRVY4QixFQUFhOUIsb0JBRWJtQyxFQUFXbkMsb0JBZ0JYYSxFQUFXckQsaUJBQWlCLFNBVDVCLFdBQ0lvRSxFQUFVL0IsT0FDVixNQUFNLEtBQUMzQixFQUFELElBQU93RCxHQUFPTixFQUFTSyxjQUM3QmEsRUFBeUIxRSxpQkFDekJzRCxFQUFVTixNQUFRMUMsRUFDbEJpRCxFQUFTUCxNQUFRYyxLQU9kLE1BQU1hLEVBQTBCLElBQUl0SCxFQUFjRSxFQUFtQjhGLEdBQzVFc0IsRUFBd0J6RSxtQkFFakIsTUFBTXdFLEVBQTJCLElBQUlySCxFQUFjRSxFQUFtQjRGLEdBQzdFdUIsRUFBeUJ4RSxtQkFhekJnRCxFQUFVdEQsaUJBQWlCLFNBTDNCLFdBQ0lzRSxFQUFhakMsT0FDYjBDLEVBQXdCM0Usb0JBTTVCLE1BQU1vRSxFQUFXLElHL0VGLE1BQ1g5RyxZQUFZLEVBQW1Cc0gsR0FBbUIsSUFBdEMsTUFBQ0MsRUFBRCxTQUFRQyxHQUE4QixFQUM5Q3JILEtBQUtzSCxPQUFTRixFQUNkcEgsS0FBS3VILFVBQVlGLEVBQ2pCckgsS0FBS3dILFdBQWFoRSxTQUFTekMsY0FBY29HLEdBRzdDUCxRQUFRL0QsRUFBTUMsR0FDVixNQUFNMkUsRUFBT3pILEtBQUt1SCxVQUFVMUUsRUFBTUMsR0FDbEM5QyxLQUFLd0gsV0FBV0UsUUFBUUQsR0FHNUJFLGNBQ0kzSCxLQUFLc0gsT0FBT3BGLFNBQVMwRixJQUNqQjVILEtBQUs0RyxRQUFRZ0IsRUFBSy9FLEtBQU0rRSxFQUFLOUUsV0hrRXJDLENBQ0lzRSxNSHhFb0IsQ0FDeEIsQ0FDSXZFLEtBQU0sa0JBQ05DLEtBQU0sb0RBRVYsQ0FDSUQsS0FBTSxjQUNOQyxLQUFNLHVEQUVWLENBQ0lELEtBQU0saUJBQ05DLEtBQU0sMERBRVYsQ0FDSUQsS0FBTSxVQUNOQyxLQUFNLG1EQUVWLENBQ0lELEtBQU0sd0JBQ05DLEtBQU0sbURBRVYsQ0FDSUQsS0FBTSxpQkFDTkMsS0FBTSxpREdrRE51RSxTQUFVLENBQUN4RSxFQUFNQyxJQUNiLElBQUlGLEVBQUtDLEVBQU1DLEVBQU0sU0FBUyxJQUMxQmdFLEVBQVd0QyxLQUFLM0IsRUFBTUMsS0FDdkJnQixnQkFFWCxvQkFHSjZDLEVBQVNnQixjIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybXMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3NWYWxpZGF0b3IsIGZvcm1FbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzVmFsaWRhdG9yLmlucHV0U2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5nc1ZhbGlkYXRvci5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3NWYWxpZGF0b3IuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5nc1ZhbGlkYXRvci5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzVmFsaWRhdG9yLmVycm9yQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIH07XHJcblxyXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIH07XHJcblxyXG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICB9O1xyXG5cclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcbiAgICB9O1xyXG5cclxuICAgIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgX2hpZGVWYWxpZGF0aW9uTWVzc2FnZSgpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICAgICAgKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHJlc2V0V2hvbGVGb3JtKCkge1xyXG4gICAgICAgIHRoaXMuX2hpZGVWYWxpZGF0aW9uTWVzc2FnZSgpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcclxuICAgIH07XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH07XHJcblxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lLCBsaW5rLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaykge1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAgICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19pdGVtXCIpXHJcbiAgICAgICAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBjb25zdCBidXR0b25EZWxldGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2J1dHRvbi1kZWxldGVcIik7XHJcbiAgICAgICAgYnV0dG9uRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24pO1xyXG5cclxuICAgICAgICBjb25zdCBidXR0b25IZWFydCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fYnV0dG9uLWhlYXJ0XCIpO1xyXG4gICAgICAgIGJ1dHRvbkhlYXJ0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKTtcclxuXHJcbiAgICAgICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19ncmlkLWltYWdlXCIpO1xyXG4gICAgICAgIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHtuYW1lOiB0aGlzLl9uYW1lLCBzcmM6IHRoaXMuX2xpbmt9KVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZURlbGV0ZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICBfaGFuZGxlTGlrZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19idXR0b24taGVhcnRcIilcclxuICAgICAgICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJlbGVtZW50c19fYnV0dG9uLWhlYXJ0X2FjdGl2ZVwiKTtcclxuICAgIH07XHJcblxyXG4gICAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19ncmlkLWltYWdlXCIpO1xyXG4gICAgICAgIGNvbnN0IGNhcmROYW1lID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19kZXNjcmlwdGlvblwiKTtcclxuICAgICAgICBjYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgICAgICBjYXJkSW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xyXG4gICAgICAgIGNhcmROYW1lLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICAgIH1cclxuXHJcbn0iLCJleHBvcnQgY29uc3Qgc2V0dGluZ3NWYWxpZGF0b3IgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faXRlbVwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b24tc2JtdFwiLFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uLXNibXRfZGlzYWJsZWRcIixcclxuICAgIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faXRlbV90eXBlX2Vycm9yXCIsXHJcbiAgICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiXHJcbiAgICB9XHJcbl07IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IobW9kYWxXaW5kb3cpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1vZGFsV2luZG93KTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4vL1RPRE8gbW92ZSBldmVudGxpc3RlbmVyIHRvIHBvcHVwIG9wZW4gJiBjbG9zZSBhbmQgZml4IGhhbmRsZSBzdWJtaXRcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikgfHxcclxuICAgICAgICAgICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2J1dHRvblwiKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKG1vZGFsV2luZG93LCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICAgICAgc3VwZXIobW9kYWxXaW5kb3cpO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0cyA9IEFycmF5LmZyb20oXHJcbiAgICAgICAgICAgIHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pdGVtXCIpXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgICAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSlcclxuICAgICAgICApO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qc1wiXHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvblwiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiXHJcbmltcG9ydCB7XHJcbiAgICBpbml0aWFsQ2FyZHMsXHJcbiAgICBzZXR0aW5nc1ZhbGlkYXRvclxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50c1wiXHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybXNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuXHJcbmNvbnN0IGJ1dHRvbkVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2J1dHRvbi11bnVzdWFsXCIpO1xyXG5jb25zdCBidXR0b25BZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2J1dHRvblwiKTtcclxuY29uc3QgZm9ybUVsZW1lbnRFZGl0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmb3JtRWxlbWVudEVkaXRcIik7XHJcbmNvbnN0IGZvcm1FbGVtZW50QWRkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmb3JtRWxlbWVudEFkZFwiKTtcclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYW1lXCIpO1xyXG5jb25zdCBqb2JJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWJvdXRcIik7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgICB1c2VyTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19oZXJvXCIsXHJcbiAgICB1c2VySm9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3JvbGVcIixcclxufSk7XHJcblxyXG5jb25zdCBlZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICAgIFwiI3BvcHVwLWVkaXRcIixcclxuICAgIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICAgIFwiI3BvcHVwLWFkZFwiLFxyXG4gICAgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXRcclxuKTtcclxuXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjcG9wdXAtdmlld2VyXCIpO1xyXG5cclxuZWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGRhdGFVc2Vycykge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YVVzZXJzKTtcclxuICAgIGVkaXRQb3B1cC5jbG9zZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0QnV0dG9uKCkge1xyXG4gICAgZWRpdFBvcHVwLm9wZW4oKTtcclxuICAgIGNvbnN0IHtuYW1lLCBqb2J9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICAgIGZvcm1FbGVtZW50RWRpdFZhbGlkYXRvci5yZXNldFdob2xlRm9ybSgpO1xyXG4gICAgbmFtZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICAgIGpvYklucHV0LnZhbHVlID0gam9iO1xyXG5cclxufVxyXG5cclxuYnV0dG9uRWRpdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRWRpdEJ1dHRvbik7XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1FbGVtZW50QWRkVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3NWYWxpZGF0b3IsIGZvcm1FbGVtZW50QWRkKTtcclxuZm9ybUVsZW1lbnRBZGRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1FbGVtZW50RWRpdFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzVmFsaWRhdG9yLCBmb3JtRWxlbWVudEVkaXQpO1xyXG5mb3JtRWxlbWVudEVkaXRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGRhdGFJbWFnZXMpIHtcclxuICAgIGNhcmRMaXN0LmFkZEl0ZW0oZGF0YUltYWdlcy50aXRsZSwgZGF0YUltYWdlc1snaW1hZ2UtbGluayddKTtcclxuICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRCdXR0b24oKSB7XHJcbiAgICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG4gICAgZm9ybUVsZW1lbnRBZGRWYWxpZGF0b3IucmVzZXRXaG9sZUZvcm0oKTtcclxufVxyXG5cclxuYnV0dG9uQWRkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVBZGRCdXR0b24pO1xyXG5cclxuLy9DcmVhdGluZyBhZGQgbmV3IGNhcmQgZnVuY3Rpb25cclxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcclxuICAgIHtcclxuICAgICAgICBpdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgICAgIHJlbmRlcmVyOiAobmFtZSwgbGluaykgPT5cclxuICAgICAgICAgICAgbmV3IENhcmQobmFtZSwgbGluaywgXCIjY2FyZFwiLCAoKSA9PiAoXHJcbiAgICAgICAgICAgICAgICBpbWFnZVBvcHVwLm9wZW4obmFtZSwgbGluaylcclxuICAgICAgICAgICAgKSkuZ2VuZXJhdGVDYXJkKCksXHJcbiAgICB9LFxyXG4gICAgXCIuZWxlbWVudHNfX2l0ZW1zXCJcclxuKTtcclxuXHJcbmNhcmRMaXN0LnJlbmRlckl0ZW1zKCk7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3Ioe3VzZXJOYW1lU2VsZWN0b3IsIHVzZXJKb2JTZWxlY3Rvcn0pIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3VzZXJKb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VySm9iU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX3VzZXJOYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgam9iOiB0aGlzLl91c2VySm9iRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbmZvKHtuYW1lLCBqb2J9KSB7XHJcbiAgICAgICAgdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICB0aGlzLl91c2VySm9iRWxlbWVudC50ZXh0Q29udGVudCA9IGpvYjtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihtb2RhbFdpbmRvdykge1xyXG4gICAgICAgIHN1cGVyKG1vZGFsV2luZG93KTtcclxuICAgICAgICB0aGlzLl9pbWFnZVpvb20gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fdmlld2VyLWltYWdlXCIpO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlWm9vbVRpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3ZpZXdlci10ZXh0XCIpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgICAgICB0aGlzLl9pbWFnZVpvb20uc3JjID0gbGluaztcclxuICAgICAgICB0aGlzLl9pbWFnZVpvb20uYWx0ID0gYFBob3RvIG9mICR7bmFtZX1gO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlWm9vbVRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3Ioe2l0ZW1zLCByZW5kZXJlcn0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0obmFtZSwgbGluaykge1xyXG4gICAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9yZW5kZXJlcihuYW1lLCBsaW5rKTtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChjYXJkKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJJdGVtcygpIHtcclxuICAgICAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkSXRlbShpdGVtLm5hbWUsIGl0ZW0ubGluayk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNldHRpbmdzVmFsaWRhdG9yIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dExpc3QiLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2J1dHRvbkVsZW1lbnQiLCJkaXNhYmxlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oaWRlVmFsaWRhdGlvbk1lc3NhZ2UiLCJBcnJheSIsImZyb20iLCJyZXNldFdob2xlRm9ybSIsInJlc2V0IiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsIm5hbWUiLCJsaW5rIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiX2VsZW1lbnQiLCJ0b2dnbGUiLCJfbmFtZSIsIl9saW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfaGFuZGxlRGVsZXRlQnV0dG9uIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJzcmMiLCJnZW5lcmF0ZUNhcmQiLCJjYXJkSW1hZ2UiLCJjYXJkTmFtZSIsImFsdCIsImZvcm1TZWxlY3RvciIsIlBvcHVwIiwibW9kYWxXaW5kb3ciLCJrZXkiLCJjbG9zZSIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfcG9wdXBGb3JtIiwiX2lucHV0cyIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsImJ1dHRvbkVkaXQiLCJidXR0b25BZGQiLCJmb3JtRWxlbWVudEVkaXQiLCJnZXRFbGVtZW50QnlJZCIsImZvcm1FbGVtZW50QWRkIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJ1c2VySW5mbyIsInVzZXJOYW1lU2VsZWN0b3IiLCJ1c2VySm9iU2VsZWN0b3IiLCJfdXNlck5hbWVFbGVtZW50IiwiX3VzZXJKb2JFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJqb2IiLCJzZXRVc2VySW5mbyIsImVkaXRQb3B1cCIsImRhdGFVc2VycyIsImFkZENhcmRQb3B1cCIsImRhdGFJbWFnZXMiLCJjYXJkTGlzdCIsImFkZEl0ZW0iLCJ0aXRsZSIsImltYWdlUG9wdXAiLCJfaW1hZ2Vab29tIiwiX2ltYWdlWm9vbVRpdGxlIiwiZm9ybUVsZW1lbnRFZGl0VmFsaWRhdG9yIiwiZm9ybUVsZW1lbnRBZGRWYWxpZGF0b3IiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiY2FyZCIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsIml0ZW0iXSwic291cmNlUm9vdCI6IiJ9