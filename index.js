!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._inputList=this._formElement.querySelectorAll(this._inputSelector),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_hideValidationMessage(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),console.log(this._inputList),this._inputList.forEach((e=>{this._hideInputError(e)}))}resetWholeForm(){this._hideValidationMessage(),this._toggleButtonState(),this._formElement.reset()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s,n,r,i,o,a,l){let{handleCardClick:h,handleLikeButton:c,handleDeleteCard:u}=l;t(this,"removeCardFromDOM",(()=>{this._element.remove(),this._element=null})),t(this,"handleLikeCard",(e=>{this._likes=e,this._renderLikes()})),this._name=e,this._link=s,this._cardSelector=a,this._handleCardClick=h,this._handleLikeButton=c,this._handleDeleteCard=u,this._id=n,this._userId=i,this._ownerId=r,this._likes=o}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".elements__item").cloneNode(!0)}_setEventListeners(){this._deleteButton.addEventListener("click",(()=>this._handleDeleteCard(this._id))),this._likeButton.addEventListener("click",(()=>this._handleLikeButton(this._id))),this._cardImage.addEventListener("click",(()=>this._handleCardClick({name:this._name,src:this._link})))}isLiked(){return this._likes.some((e=>e._id===this._userId))}_renderLikes(){this._likesCount.textContent=this._likes.length,this.isLiked()?this._likeButton.classList.add("elements__button-heart_active"):this._likeButton.classList.remove("elements__button-heart_active")}generateCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".elements__grid-image"),this._cardName=this._element.querySelector(".elements__description"),this._likesCount=this._element.querySelector(".elements__amount-likes"),this._likeButton=this._element.querySelector(".elements__button-heart"),this._deleteButton=this._element.querySelector(".elements__button-delete"),this._setEventListeners(),this._cardImage.src=this._link,this._cardImage.alt="Photo of ".concat(this._name),this._cardName.textContent=this._name,this._renderLikes(),this._ownerId!==this._userId&&(this._deleteButton.style.display="none"),this._element}}const n={formSelector:".popup__form",inputSelector:".popup__item",submitButtonSelector:".popup__button-sbmt",inactiveButtonClass:"popup__button-sbmt_disabled",inputErrorClass:"popup__item_type_error",errorClass:"popup__error_visible"};class r{constructor(e){var t,s;s=e=>{"Escape"===e.key&&this.close()},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__button"))&&this.close()}))}}class i extends r{constructor(e,t,s){super(e),this._handleFormSubmit=t,this._popupForm=this._popupElement.querySelector(".popup__form"),this._buttonSubmit=this._popupElement.querySelector(".popup__button-sbmt"),this._buttonTextValue=s,this._inputs=Array.from(this._popupForm.querySelectorAll(".popup__item"))}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}formReset(){this._popupForm.reset()}showMessageLoading(){this._buttonSubmit.value="Saving..."}hideMessageLoading(){this._buttonSubmit.value=this._buttonTextValue}close(){super.close(),this._popupForm.reset()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>this._handleFormSubmit(this._getInputValues())))}}const o=document.querySelector(".profile__button-unusual"),a=document.querySelector(".profile__button"),l=document.getElementById("formElementEdit"),h=document.getElementById("formElementAdd"),c=document.getElementById("formElementImage"),u=document.getElementById("name"),d=document.getElementById("about"),_=document.querySelector(".profile__image-overlay"),m=new class{constructor(e){let{baseUrl:t,headers:s}=e;var n,r;r=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))),(n="_customFetch")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r,this._baseUrl=t,this._headers=s}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}getInitialCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers})}createCard(e){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"})}editProfile(e){let{name:t,about:s}=e;return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:s})})}editAvatar(e){let{avatar:t}=e;return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:t})})}likeCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}unlikeCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"cc8ab050-a9c0-4b6f-94ee-d21a7e05974a","Content-Type":"application/json"}}),p=new class{constructor(e){let{userNameSelector:t,userJobSelector:s,avatarSelector:n}=e;this._userNameElement=document.querySelector(t),this._userJobElement=document.querySelector(s),this._avatarElement=document.querySelector(n)}getUserInfo(){return{name:this._userNameElement.textContent,about:this._userJobElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._userNameElement.textContent=t,this._userJobElement.textContent=s}setAvatar(e){let{avatar:t}=e;this._avatarElement.style.backgroundImage="url(".concat(t||this._avatar,")")}}({userNameSelector:".profile__hero",userJobSelector:".profile__role",avatarSelector:".profile__avatar"}),E=new i("#popup-edit",(function(e){E.showMessageLoading(),m.editProfile(e).then((e=>{p.setUserInfo(e),E.formReset(),E.close()})).catch((e=>{console.log("Error: ".concat(e))})).finally((()=>{}))}),"Save"),b=new i("#popup-add",(function(e){b.showMessageLoading();const t={name:e.title,link:e["image-link"]};m.createCard(t).then((e=>{y.addItem(e.name,e.link,e._id,e.owner._id,e.likes),b.formReset(),b.close()})).catch((e=>{console.log("Error: ".concat(e))})).finally((()=>{b.hideMessageLoading()}))}),"Create"),v=new class extends r{constructor(e){super(e),this._imageZoom=this._popupElement.querySelector(".popup__viewer-image"),this._imageZoomTitle=this._popupElement.querySelector(".popup__viewer-text")}open(e,t){super.open(),this._imageZoom.src=t,this._imageZoom.alt="Photo of ".concat(e),this._imageZoomTitle.textContent=e}}("#popup-viewer"),g=new class extends r{constructor(e){super(e),this._inputSubmit=this._popupElement.querySelector(".popup__button-sbmt")}setAction(e){this._handleSubmit=e}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}showMessageLoading(){this._inputSubmit.value="Saving..."}hideMessageLoading(){this._inputSubmit.value="Saved"}}("#popup-delete"),L=new i("#popup-profile-image",(function(e){L.showMessageLoading(),m.editAvatar(e).then((e=>{p.setAvatar(e),L.formReset(),L.close()})).catch((e=>{console.log("Error: ".concat(e))})).finally((()=>{L.hideMessageLoading()}))}),"Save");E.setEventListeners(),b.setEventListeners(),v.setEventListeners(),g.setEventListeners(),L.setEventListeners(),o.addEventListener("click",(function(){E.open();const{name:e,about:t}=p.getUserInfo();S.resetWholeForm(),u.value=e,d.value=t}));const f=new e(n,h);f.enableValidation();const S=new e(n,l);S.enableValidation();const C=new e(n,c);C.enableValidation(),a.addEventListener("click",(function(){b.open(),f.resetWholeForm()}));const y=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}addItem(e,t,s,n,r){const i=this._renderer(e,t,s,n,r);this._container.prepend(i)}renderItems(e){e.forEach((e=>{this.addItem(e.name,e.link,e._id,e.owner._id,e.likes)}))}}({renderer:(e,t,n,r,i)=>{const o=new s(e,t,n,r,k,i,"#card",{handleCardClick:()=>{v.open(e,t)},handleDeleteCard:e=>{g.open(),g.setAction((()=>{g.showMessageLoading(),m.deleteCard(e).then((()=>{o.removeCardFromDOM(),g.close()})).catch((e=>{console.log("Error: ".concat(e))})).finally((()=>{g.hideMessageLoading()}))}))},handleLikeButton:e=>{o.isLiked()?m.unlikeCard(e).then((e=>{o.handleLikeCard(e.likes)})).catch((e=>{console.log("Error: ".concat(e))})):m.likeCard(e).then((e=>{o.handleLikeCard(e.likes)})).catch((e=>{console.log("Error: ".concat(e))}))}});return o.generateCard()}},".elements__items");let k;Promise.all([m.getUserInfo(),m.getInitialCards()]).then((e=>{let[t,s]=e;k=t._id,p.setUserInfo({name:t.name,about:t.about}),p.setAvatar({avatar:t.avatar}),y.renderItems(s.reverse())})).catch((e=>{console.log("Error: ".concat(e))})),_.addEventListener("click",(function(){L.open(),C.resetWholeForm()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QW1CdkMsSUFDZm9LLEVBQVl4RixPQUNad0YsRUFBWUcsV0FBVSxLQUNsQkgsRUFBWXBFLHFCQUNaVyxFQUNLdUIsV0FBV2xJLEdBQ1hnSCxNQUFLLEtBQ0ZtRSxFQUFLSyxvQkFDTHBCLEVBQVkxRixXQUVmOEUsT0FBT0MsSUFDSmxJLFFBQVFDLElBQVIsaUJBQXNCaUksT0FFekJDLFNBQVEsS0FDTFUsRUFBWW5FLDRCQUk1QjNELGlCQUFtQnRDLElBQ1FtTCxFQUFLdEgsVUFFeEI4QyxFQUNLOEIsV0FBV3pJLEdBQ1hnSCxNQUFNQyxJQUNIa0UsRUFBS00sZUFBZXhFLEVBQUk5RSxVQUUzQnFILE9BQU9DLElBQ0psSSxRQUFRQyxJQUFSLGlCQUFzQmlJLE9BRzlCOUMsRUFDSzZCLFNBQVN4SSxHQUNUZ0gsTUFBTUMsSUFDSGtFLEVBQUtNLGVBQWV4RSxFQUFJOUUsVUFFM0JxSCxPQUFPQyxJQUNKbEksUUFBUUMsSUFBUixpQkFBc0JpSSxVQUsxQyxPQUFPMEIsRUFBS2xILGlCQUVqQixvQkFHSCxJQUFJL0IsRUFDSmtGLFFBQVFzRSxJQUFJLENBQUMvRSxFQUFJYyxjQUFlZCxFQUFJZ0Isb0JBQy9CWCxNQUFLLElBQTBCLElBQXhCMkQsRUFBVWdCLEdBQWMsRUFDNUJ6SixFQUFTeUksRUFBU3pILElBQ2xCeUYsRUFBU08sWUFBWSxDQUNqQm5ILEtBQU00SSxFQUFTNUksS0FBTXNHLE1BQU9zQyxFQUFTdEMsUUFFekNNLEVBQVNRLFVBQVUsQ0FBQ1osT0FBUW9DLEVBQVNwQyxTQUNyQ3VCLEVBQVN1QixZQUFZTSxFQUFTQyxjQUVyQ3BDLE9BQU9DLElBQ0psSSxRQUFRQyxJQUFSLGlCQUFzQmlJLE9BUzFCL0MsRUFBb0J2RixpQkFBaUIsU0FOckMsV0FDSXVKLEVBQWtCOUYsT0FDbEJrRyxFQUEwQnJKLG9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybXMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRpbmcuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzVmFsaWRhdG9yLCBmb3JtRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5nc1ZhbGlkYXRvci5pbnB1dFNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3NWYWxpZGF0b3Iuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzVmFsaWRhdG9yLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3NWYWxpZGF0b3IuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5nc1ZhbGlkYXRvci5lcnJvckNsYXNzO1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB9O1xyXG5cclxuICAgIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgfTtcclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gICAgfTtcclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIF9oaWRlVmFsaWRhdGlvbk1lc3NhZ2UoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5faW5wdXRMaXN0KVxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgcmVzZXRXaG9sZUZvcm0oKSB7XHJcbiAgICAgICAgdGhpcy5faGlkZVZhbGlkYXRpb25NZXNzYWdlKCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfTtcclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIG5hbWUsIGxpbmssIGlkLCBvd25lcklkLCB1c2VySWQsIGxpa2VzLCBjYXJkU2VsZWN0b3IsXHJcbiAgICAgICAge2hhbmRsZUNhcmRDbGljaywgaGFuZGxlTGlrZUJ1dHRvbiwgaGFuZGxlRGVsZXRlQ2FyZH0sXHJcblxyXG5cclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbiA9IGhhbmRsZUxpa2VCdXR0b247XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgICAgICAgdGhpcy5faWQgPSBpZDtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IG93bmVySWQ7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgICAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2l0ZW1cIilcclxuICAgICAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLl9pZClcclxuICAgICAgICApO1xyXG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24odGhpcy5faWQpXHJcbiAgICAgICAgKTtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIHNyYzogdGhpcy5fbGluayB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ2FyZEZyb21ET00gPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICAgIH07XHJcblxyXG5cclxuICAgIGlzTGlrZWQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlZENhcmQpID0+IGxpa2VkQ2FyZC5faWQgPT09IHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9XHJcbiAgICBoYW5kbGVMaWtlQ2FyZCA9IChhZGRMaWtlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBhZGRMaWtlO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgICB9O1xyXG4gICAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlc0NvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50c19fYnV0dG9uLWhlYXJ0X2FjdGl2ZVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJlbGVtZW50c19fYnV0dG9uLWhlYXJ0X2FjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2dyaWQtaW1hZ2VcIik7XHJcbiAgICAgICAgdGhpcy5fY2FyZE5hbWUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2Rlc2NyaXB0aW9uXCIpO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzQ291bnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2Ftb3VudC1saWtlc1wiKTtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19idXR0b24taGVhcnRcIik7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19idXR0b24tZGVsZXRlXCIpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IGBQaG90byBvZiAke3RoaXMuX25hbWV9YDtcclxuICAgICAgICB0aGlzLl9jYXJkTmFtZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICAgICAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gICAgfVxyXG5cclxufSIsImV4cG9ydCBjb25zdCBzZXR0aW5nc1ZhbGlkYXRvciA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pdGVtXCIsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvbi1zYm10XCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b24tc2JtdF9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pdGVtX3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKG1vZGFsV2luZG93KSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihtb2RhbFdpbmRvdyk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlbmVkXCIpIHx8XHJcbiAgICAgICAgICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19idXR0b25cIilcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKG1vZGFsV2luZG93LCBoYW5kbGVGb3JtU3VibWl0LCBidXR0b25UZXh0VmFsdWUpIHtcclxuICAgICAgICBzdXBlcihtb2RhbFdpbmRvdyk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uU3VibWl0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvbi1zYm10XCIpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvblRleHRWYWx1ZSA9IGJ1dHRvblRleHRWYWx1ZTtcclxuICAgICAgICB0aGlzLl9pbnB1dHMgPSBBcnJheS5mcm9tKFxyXG4gICAgICAgICAgICB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faXRlbVwiKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICAgICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gICAgfVxyXG5cclxuICAgIGZvcm1SZXNldCgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzaG93TWVzc2FnZUxvYWRpbmcoKSB7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uU3VibWl0LnZhbHVlID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH1cclxuICAgIGhpZGVNZXNzYWdlTG9hZGluZygpIHtcclxuICAgICAgICB0aGlzLl9idXR0b25TdWJtaXQudmFsdWUgPSB0aGlzLl9idXR0b25UZXh0VmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSlcclxuICAgICAgICApO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qc1wiXHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvblwiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiXHJcbmltcG9ydCB7XHJcbiAgICBzZXR0aW5nc1ZhbGlkYXRvclxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50c1wiXHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybXNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQge1BvcHVwV2l0aERlbGV0aW5nfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aERlbGV0aW5nXCI7XHJcblxyXG5jb25zdCBidXR0b25FZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19idXR0b24tdW51c3VhbFwiKTtcclxuY29uc3QgYnV0dG9uQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19idXR0b25cIik7XHJcbmNvbnN0IGZvcm1FbGVtZW50RWRpdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9ybUVsZW1lbnRFZGl0XCIpO1xyXG5jb25zdCBmb3JtRWxlbWVudEFkZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9ybUVsZW1lbnRBZGRcIik7XHJcbmNvbnN0IGZvcm1FbGVtZW50SW1hZ2U9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9ybUVsZW1lbnRJbWFnZVwiKTtcclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYW1lXCIpO1xyXG5jb25zdCBqb2JJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWJvdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZU92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLW92ZXJsYXlcIilcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gICAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcImNjOGFiMDUwLWE5YzAtNGI2Zi05NGVlLWQyMWE3ZTA1OTc0YVwiLCBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgIH0sXHJcbn0pO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gICAgdXNlck5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9faGVyb1wiLCB1c2VySm9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3JvbGVcIiwgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2F2YXRhclwiLFxyXG59KTtcclxuXHJcblxyXG5jb25zdCBlZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwb3B1cC1lZGl0XCIsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0LCBcIlNhdmVcIik7XHJcblxyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwb3B1cC1hZGRcIiwgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQsIFwiQ3JlYXRlXCIpO1xyXG5cclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNwb3B1cC12aWV3ZXJcIik7XHJcblxyXG5jb25zdCBkZWxldGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhEZWxldGluZyhcIiNwb3B1cC1kZWxldGVcIik7XHJcblxyXG5jb25zdCBwcm9maWxlSW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3BvcHVwLXByb2ZpbGUtaW1hZ2VcIiwgaGFuZGxlSW1hZ2VGb3JtU3VibWl0LCBcIlNhdmVcIik7XHJcblxyXG5lZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbnByb2ZpbGVJbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChkYXRhVXNlcnMpIHtcclxuICAgIGVkaXRQb3B1cC5zaG93TWVzc2FnZUxvYWRpbmcoKTtcclxuICAgIGFwaVxyXG4gICAgICAgIC5lZGl0UHJvZmlsZShkYXRhVXNlcnMpXHJcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgICAgICAgICBlZGl0UG9wdXAuZm9ybVJlc2V0KCk7XHJcbiAgICAgICAgICAgIGVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuXHJcbiAgICAgICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRCdXR0b24oKSB7XHJcbiAgICBlZGl0UG9wdXAub3BlbigpO1xyXG4gICAgY29uc3Qge25hbWUsIGFib3V0fSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgICBmb3JtRWxlbWVudEVkaXRWYWxpZGF0b3IucmVzZXRXaG9sZUZvcm0oKTtcclxuICAgIG5hbWVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgICBqb2JJbnB1dC52YWx1ZSA9IGFib3V0O1xyXG5cclxufVxyXG5cclxuYnV0dG9uRWRpdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRWRpdEJ1dHRvbik7XHJcblxyXG5leHBvcnQgY29uc3QgZm9ybUVsZW1lbnRBZGRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5nc1ZhbGlkYXRvciwgZm9ybUVsZW1lbnRBZGQpO1xyXG5mb3JtRWxlbWVudEFkZFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5leHBvcnQgY29uc3QgZm9ybUVsZW1lbnRFZGl0VmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3NWYWxpZGF0b3IsIGZvcm1FbGVtZW50RWRpdCk7XHJcbmZvcm1FbGVtZW50RWRpdFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5leHBvcnQgY29uc3QgZm9ybUVsZW1lbnRJbWFnZVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzVmFsaWRhdG9yLCBmb3JtRWxlbWVudEltYWdlKTtcclxuZm9ybUVsZW1lbnRJbWFnZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdChkYXRhSW1hZ2VzKSB7XHJcbiAgICBhZGRDYXJkUG9wdXAuc2hvd01lc3NhZ2VMb2FkaW5nKCk7XHJcbiAgICBjb25zdCBkYXRhID0ge1xyXG4gICAgICAgIG5hbWU6IGRhdGFJbWFnZXMudGl0bGUsXHJcbiAgICAgICAgbGluazogZGF0YUltYWdlc1snaW1hZ2UtbGluayddLFxyXG4gICAgfTtcclxuICAgIGFwaVxyXG4gICAgICAgIC5jcmVhdGVDYXJkKGRhdGEpXHJcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKHJlcy5uYW1lLCByZXMubGluaywgcmVzLl9pZCwgcmVzLm93bmVyLl9pZCwgcmVzLmxpa2VzKTtcclxuICAgICAgICAgICAgYWRkQ2FyZFBvcHVwLmZvcm1SZXNldCgpO1xyXG4gICAgICAgICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJ9YCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGFkZENhcmRQb3B1cC5oaWRlTWVzc2FnZUxvYWRpbmcoKTtcclxuICAgICAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQnV0dG9uKCkge1xyXG4gICAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcclxuICAgIGZvcm1FbGVtZW50QWRkVmFsaWRhdG9yLnJlc2V0V2hvbGVGb3JtKCk7XHJcbn1cclxuYnV0dG9uQWRkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVBZGRCdXR0b24pO1xyXG5cclxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbih7XHJcbiAgICByZW5kZXJlcjogKG5hbWUsIGxpbmssIGlkLCBvd25lcklkLCBsaWtlcykgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChuYW1lLCBsaW5rLCBpZCwgb3duZXJJZCwgdXNlcklkLCBsaWtlcywgXCIjY2FyZFwiLCB7XHJcbiAgICAgICAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaW1hZ2VQb3B1cC5vcGVuKG5hbWUsIGxpbmspO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBoYW5kbGVEZWxldGVDYXJkOiAoaWQpID0+IHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZVBvcHVwLm9wZW4oKTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZVBvcHVwLnNldEFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlUG9wdXAuc2hvd01lc3NhZ2VMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kZWxldGVDYXJkKGlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLnJlbW92ZUNhcmRGcm9tRE9NKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlUG9wdXAuaGlkZU1lc3NhZ2VMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGhhbmRsZUxpa2VCdXR0b246IChpZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXNBbHJlYWR5TGlrZWQgPSBjYXJkLmlzTGlrZWQoKTtcclxuICAgICAgICAgICAgICAgIGlmIChpc0FscmVhZHlMaWtlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudW5saWtlQ2FyZChpZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZC5oYW5kbGVMaWtlQ2FyZChyZXMubGlrZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAubGlrZUNhcmQoaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmQuaGFuZGxlTGlrZUNhcmQocmVzLmxpa2VzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJ9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKClcclxuICAgIH1cclxufSwgXCIuZWxlbWVudHNfX2l0ZW1zXCIpO1xyXG5cclxuXHJcbmxldCB1c2VySWQ7XHJcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAgIC50aGVuKChbdXNlckRhdGEsIGNhcmREYXRhXSkgPT4ge1xyXG4gICAgICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcclxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsIGFib3V0OiB1c2VyRGF0YS5hYm91dCxcclxuICAgICAgICB9KTtcclxuICAgICAgICB1c2VySW5mby5zZXRBdmF0YXIoe2F2YXRhcjogdXNlckRhdGEuYXZhdGFyfSk7XHJcbiAgICAgICAgY2FyZExpc3QucmVuZGVySXRlbXMoY2FyZERhdGEucmV2ZXJzZSgpKTtcclxuICAgIH0pXHJcbi5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVJbWFnZUNsaWNrKCkge1xyXG4gICAgcHJvZmlsZUltYWdlUG9wdXAub3BlbigpO1xyXG4gICAgZm9ybUVsZW1lbnRJbWFnZVZhbGlkYXRvci5yZXNldFdob2xlRm9ybSgpO1xyXG5cclxufVxyXG5cclxucHJvZmlsZUltYWdlT3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlUHJvZmlsZUltYWdlQ2xpY2spO1xyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUZvcm1TdWJtaXQodXNlckRhdGEpIHtcclxuICAgIHByb2ZpbGVJbWFnZVBvcHVwLnNob3dNZXNzYWdlTG9hZGluZygpO1xyXG4gICAgYXBpXHJcbiAgICAgICAgLmVkaXRBdmF0YXIodXNlckRhdGEpXHJcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICB1c2VySW5mby5zZXRBdmF0YXIocmVzKTtcclxuICAgICAgICAgICAgcHJvZmlsZUltYWdlUG9wdXAuZm9ybVJlc2V0KCk7XHJcbiAgICAgICAgICAgIHByb2ZpbGVJbWFnZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBwcm9maWxlSW1hZ2VQb3B1cC5oaWRlTWVzc2FnZUxvYWRpbmcoKTtcclxuICAgICAgICB9KTtcclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7YmFzZVVybCwgaGVhZGVyc30pIHtcclxuICAgICAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgICAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICAgIH1cclxuXHJcbiAgICBfY3VzdG9tRmV0Y2ggPSAodXJsLCBoZWFkZXJzKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKHVybCwgaGVhZGVycykudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlQ2FyZChkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBlZGl0UHJvZmlsZSh7bmFtZSwgYWJvdXR9KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgIGFib3V0OiBhYm91dCxcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZWRpdEF2YXRhcih7YXZhdGFyfSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBhdmF0YXI6IGF2YXRhcixcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHVubGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKHt1c2VyTmFtZVNlbGVjdG9yLCB1c2VySm9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yfSkge1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fdXNlckpvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJKb2JTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX3VzZXJOYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgYWJvdXQ6IHRoaXMuX3VzZXJKb2JFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckluZm8oe25hbWUsIGFib3V0fSkge1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fdXNlckpvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICAgIH1cclxuXHJcbiAgICBzZXRBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYXZhdGFyXHJcbiAgICAgICAgICAgID8gYHVybCgke2F2YXRhcn0pYFxyXG4gICAgICAgICAgICA6IGB1cmwoJHt0aGlzLl9hdmF0YXJ9KWA7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IobW9kYWxXaW5kb3cpIHtcclxuICAgICAgICBzdXBlcihtb2RhbFdpbmRvdyk7XHJcbiAgICAgICAgdGhpcy5faW1hZ2Vab29tID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3ZpZXdlci1pbWFnZVwiKTtcclxuICAgICAgICB0aGlzLl9pbWFnZVpvb21UaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX192aWV3ZXItdGV4dFwiKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICAgICAgdGhpcy5faW1hZ2Vab29tLnNyYyA9IGxpbms7XHJcbiAgICAgICAgdGhpcy5faW1hZ2Vab29tLmFsdCA9IGBQaG90byBvZiAke25hbWV9YDtcclxuICAgICAgICB0aGlzLl9pbWFnZVpvb21UaXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhEZWxldGluZyBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9pbnB1dFN1Ym1pdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b24tc2JtdFwiKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0ID0gYWN0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3dNZXNzYWdlTG9hZGluZygpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dFN1Ym1pdC52YWx1ZSA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9XHJcblxyXG4gICAgaGlkZU1lc3NhZ2VMb2FkaW5nKCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0U3VibWl0LnZhbHVlID0gXCJTYXZlZFwiO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7cmVuZGVyZXJ9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkSXRlbShuYW1lLCBsaW5rLCBpZCwgb3duZXJJZCwgbGlrZXMpIHtcclxuICAgICAgICBjb25zdCBjYXJkID0gdGhpcy5fcmVuZGVyZXIobmFtZSwgbGluaywgaWQsIG93bmVySWQsIGxpa2VzKTtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChjYXJkKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5hZGRJdGVtKGl0ZW0ubmFtZSwgaXRlbS5saW5rLCBpdGVtLl9pZCwgaXRlbS5vd25lci5faWQsIGl0ZW0ubGlrZXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5nc1ZhbGlkYXRvciIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRMaXN0Iiwic29tZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9idXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGlkZVZhbGlkYXRpb25NZXNzYWdlIiwiQXJyYXkiLCJmcm9tIiwiY29uc29sZSIsImxvZyIsInJlc2V0V2hvbGVGb3JtIiwicmVzZXQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwibmFtZSIsImxpbmsiLCJvd25lcklkIiwidXNlcklkIiwibGlrZXMiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVMaWtlQnV0dG9uIiwiaGFuZGxlRGVsZXRlQ2FyZCIsIl9lbGVtZW50IiwiYWRkTGlrZSIsIl9saWtlcyIsIl9yZW5kZXJMaWtlcyIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfaWQiLCJfdXNlcklkIiwiX293bmVySWQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfZGVsZXRlQnV0dG9uIiwiX2xpa2VCdXR0b24iLCJfY2FyZEltYWdlIiwic3JjIiwiaXNMaWtlZCIsImxpa2VkQ2FyZCIsIl9saWtlc0NvdW50IiwibGVuZ3RoIiwiZ2VuZXJhdGVDYXJkIiwiX2NhcmROYW1lIiwiYWx0Iiwic3R5bGUiLCJkaXNwbGF5IiwiZm9ybVNlbGVjdG9yIiwiUG9wdXAiLCJtb2RhbFdpbmRvdyIsImtleSIsImNsb3NlIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwiYnV0dG9uVGV4dFZhbHVlIiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9wb3B1cEZvcm0iLCJfYnV0dG9uU3VibWl0IiwiX2J1dHRvblRleHRWYWx1ZSIsIl9pbnB1dHMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJmb3JtUmVzZXQiLCJzaG93TWVzc2FnZUxvYWRpbmciLCJoaWRlTWVzc2FnZUxvYWRpbmciLCJidXR0b25FZGl0IiwiYnV0dG9uQWRkIiwiZm9ybUVsZW1lbnRFZGl0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JtRWxlbWVudEFkZCIsImZvcm1FbGVtZW50SW1hZ2UiLCJuYW1lSW5wdXQiLCJqb2JJbnB1dCIsInByb2ZpbGVJbWFnZU92ZXJsYXkiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsInVybCIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0VXNlckluZm8iLCJfY3VzdG9tRmV0Y2giLCJnZXRJbml0aWFsQ2FyZHMiLCJjcmVhdGVDYXJkIiwiZGF0YSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImVkaXRQcm9maWxlIiwiYWJvdXQiLCJlZGl0QXZhdGFyIiwiYXZhdGFyIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJbmZvIiwidXNlck5hbWVTZWxlY3RvciIsInVzZXJKb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX3VzZXJOYW1lRWxlbWVudCIsIl91c2VySm9iRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50Iiwic2V0VXNlckluZm8iLCJzZXRBdmF0YXIiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJfYXZhdGFyIiwiZWRpdFBvcHVwIiwiZGF0YVVzZXJzIiwiY2F0Y2giLCJlcnIiLCJmaW5hbGx5IiwiYWRkQ2FyZFBvcHVwIiwiZGF0YUltYWdlcyIsInRpdGxlIiwiY2FyZExpc3QiLCJhZGRJdGVtIiwib3duZXIiLCJpbWFnZVBvcHVwIiwiX2ltYWdlWm9vbSIsIl9pbWFnZVpvb21UaXRsZSIsImRlbGV0ZVBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9pbnB1dFN1Ym1pdCIsInNldEFjdGlvbiIsImFjdGlvbiIsIl9oYW5kbGVTdWJtaXQiLCJwcm9maWxlSW1hZ2VQb3B1cCIsInVzZXJEYXRhIiwiZm9ybUVsZW1lbnRFZGl0VmFsaWRhdG9yIiwiZm9ybUVsZW1lbnRBZGRWYWxpZGF0b3IiLCJmb3JtRWxlbWVudEltYWdlVmFsaWRhdG9yIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJjYXJkIiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwicmVtb3ZlQ2FyZEZyb21ET00iLCJoYW5kbGVMaWtlQ2FyZCIsImFsbCIsImNhcmREYXRhIiwicmV2ZXJzZSJdLCJzb3VyY2VSb290IjoiIn0=