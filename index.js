!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._inputList=this._formElement.querySelectorAll(this._inputSelector),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_hideValidationMessage(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),console.log(this._inputList),this._inputList.forEach((e=>{this._hideInputError(e)}))}resetWholeForm(){this._hideValidationMessage(),this._toggleButtonState(),this._formElement.reset()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s,n,r,i,o,a,l){let{handleCardClick:h,handleLikeButton:c,handleDeleteCard:u}=l;t(this,"removeCardFromDOM",(()=>{this._element.remove(),this._element=null})),t(this,"handleLikeCard",(e=>{this._likes=e,this._renderLikes()})),this._name=e,this._link=s,this._cardSelector=a,this._handleCardClick=h,this._handleLikeButton=c,this._handleDeleteCard=u,this._id=n,this._userId=i,this._ownerId=r,this._likes=o}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".elements__item").cloneNode(!0)}_setEventListeners(){this._deleteButton.addEventListener("click",(()=>this._handleDeleteCard(this._id))),this._likeButton.addEventListener("click",(()=>this._handleLikeButton(this._id))),this._cardImage.addEventListener("click",(()=>this._handleCardClick({name:this._name,src:this._link})))}isLiked(){return this._likes.some((e=>e._id===this._userId))}_renderLikes(){this._likesCount.textContent=this._likes.length,this.isLiked()?this._likeButton.classList.add("elements__button-heart_active"):this._likeButton.classList.remove("elements__button-heart_active")}generateCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".elements__grid-image"),this._cardName=this._element.querySelector(".elements__description"),this._likesCount=this._element.querySelector(".elements__amount-likes"),this._likeButton=this._element.querySelector(".elements__button-heart"),this._deleteButton=this._element.querySelector(".elements__button-delete"),this._setEventListeners(),this._cardImage.src=this._link,this._cardImage.alt="Photo of ".concat(this._name),this._cardName.textContent=this._name,this._renderLikes(),this._ownerId!==this._userId&&(this._deleteButton.style.display="none"),this._element}}const n={formSelector:".popup__form",inputSelector:".popup__item",submitButtonSelector:".popup__button-sbmt",inactiveButtonClass:"popup__button-sbmt_disabled",inputErrorClass:"popup__item_type_error",errorClass:"popup__error_visible"};class r{constructor(e){var t,s;s=e=>{"Escape"===e.key&&this.close()},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__button"))&&this.close()}))}}class i extends r{constructor(e,t,s){super(e),this._handleFormSubmit=t,this._popupForm=this._popupElement.querySelector(".popup__form"),this._buttonSubmit=this._popupElement.querySelector(".popup__button-sbmt"),this._buttonTextValue=s,this._inputs=Array.from(this._popupForm.querySelectorAll(".popup__item"))}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}formReset(){this._popupForm.reset()}showMessageLoading(){this._buttonSubmit.value="Saving..."}hideMessageLoading(){this._buttonSubmit.value=this._buttonTextValue}close(){super.close(),this._popupForm.reset()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>this._handleFormSubmit(this._getInputValues())))}}const o=document.querySelector(".profile__button-unusual"),a=document.querySelector(".profile__button"),l=document.getElementById("formElementEdit"),h=document.getElementById("formElementAdd"),c=document.getElementById("formElementImage"),u=document.getElementById("name"),d=document.getElementById("about"),_=document.querySelector(".profile__avatar"),m=new class{constructor(e){let{baseUrl:t,headers:s}=e;var n,r;r=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))),(n="_customFetch")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r,this._baseUrl=t,this._headers=s}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}getInitialCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers})}createCard(e){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"})}editProfile(e){let{name:t,about:s}=e;return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:s})})}editAvatar(e){let{avatar:t}=e;return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:t})})}likeCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}unlikeCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"cc8ab050-a9c0-4b6f-94ee-d21a7e05974a","Content-Type":"application/json"}}),p=new class{constructor(e){let{userNameSelector:t,userJobSelector:s,avatarSelector:n}=e;this._userNameElement=document.querySelector(t),this._userJobElement=document.querySelector(s),this._avatarElement=document.querySelector(n)}getUserInfo(){return{name:this._userNameElement.textContent,about:this._userJobElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._userNameElement.textContent=t,this._userJobElement.textContent=s}setAvatar(e){let{avatar:t}=e;this._avatarElement.style.backgroundImage="url(".concat(t||this._avatar,")")}}({userNameSelector:".profile__hero",userJobSelector:".profile__role",avatarSelector:".profile__avatar"}),E=new i("#popup-edit",(function(e){E.showMessageLoading(),m.editProfile(e).then((e=>{p.setUserInfo(e),E.formReset(),E.close()})).catch((e=>{console.log("Error: ".concat(e))})).finally((()=>{}))}),"Save"),b=new i("#popup-add",(function(e){b.showMessageLoading();const t={name:e.title,link:e["image-link"]};m.createCard(t).then((e=>{k.addItem(e.name,e.link,e._id,e.owner._id,e.likes),b.formReset(),b.close()})).catch((e=>{console.log("Error: ".concat(e))})).finally((()=>{b.hideMessageLoading()}))}),"Create"),v=new class extends r{constructor(e){super(e),this._imageZoom=this._popupElement.querySelector(".popup__viewer-image"),this._imageZoomTitle=this._popupElement.querySelector(".popup__viewer-text")}open(e,t){super.open(),this._imageZoom.src=t,this._imageZoom.alt="Photo of ".concat(e),this._imageZoomTitle.textContent=e}}("#popup-viewer"),g=new class extends r{constructor(e){super(e),this._inputSubmit=this._popupElement.querySelector(".popup__button-sbmt")}setAction(e){this._handleSubmit=e}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}showMessageLoading(){this._inputSubmit.value="Saving..."}hideMessageLoading(){this._inputSubmit.value="Saved"}}("#popup-delete"),L=new i("#popup-profile-image",(function(e){L.showMessageLoading(),m.editAvatar(e).then((e=>{p.setAvatar(e),L.formReset(),L.close()})).catch((e=>{console.log("Error: ".concat(e))})).finally((()=>{L.hideMessageLoading()}))}),"Save");E.setEventListeners(),b.setEventListeners(),v.setEventListeners(),g.setEventListeners(),L.setEventListeners(),o.addEventListener("click",(function(){E.open();const{name:e,about:t}=p.getUserInfo();S.resetWholeForm(),u.value=e,d.value=t}));const f=new e(n,h);f.enableValidation();const S=new e(n,l);S.enableValidation();const C=new e(n,c);C.enableValidation(),a.addEventListener("click",(function(){b.open(),f.resetWholeForm()}));const k=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}addItem(e,t,s,n,r){const i=this._renderer(e,t,s,n,r);this._container.prepend(i)}renderItems(e){e.forEach((e=>{this.addItem(e.name,e.link,e._id,e.owner._id,e.likes)}))}}({renderer:(e,t,n,r,i)=>{const o=new s(e,t,n,r,y,i,"#card",{handleCardClick:()=>{v.open(e,t)},handleDeleteCard:e=>{g.open(),g.setAction((()=>{g.showMessageLoading(),m.deleteCard(e).then((()=>{o.removeCardFromDOM(),g.close()})).catch((e=>{console.log("Error: ".concat(e))})).finally((()=>{g.hideMessageLoading()}))}))},handleLikeButton:e=>{o.isLiked()?m.unlikeCard(e).then((e=>{o.handleLikeCard(e.likes)})).catch((e=>{console.log("Error: ".concat(e))})):m.likeCard(e).then((e=>{o.handleLikeCard(e.likes)})).catch((e=>{console.log("Error: ".concat(e))}))}});return o.generateCard()}},".elements__items");let y;Promise.all([m.getUserInfo(),m.getInitialCards()]).then((e=>{let[t,s]=e;y=t._id,p.setUserInfo({name:t.name,about:t.about}),p.setAvatar({avatar:t.avatar}),k.renderItems(s.reverse())})).catch((e=>{console.log("Error: ".concat(e))})),_.addEventListener("click",(function(){L.open(),C.resetWholeForm()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJtYXBwaW5ncyI6InlCQUFlLE1BQU1BLEVBQ2pCQyxZQUFZQyxFQUFtQkMsR0FDM0JDLEtBQUtDLGVBQWlCSCxFQUFrQkksY0FDeENGLEtBQUtHLHNCQUF3QkwsRUFBa0JNLHFCQUMvQ0osS0FBS0sscUJBQXVCUCxFQUFrQlEsb0JBQzlDTixLQUFLTyxpQkFBbUJULEVBQWtCVSxnQkFDMUNSLEtBQUtTLFlBQWNYLEVBQWtCWSxXQUNyQ1YsS0FBS1csYUFBZVosRUFHeEJhLGdCQUFnQkMsR0FDWixNQUFNQyxFQUFlZCxLQUFLVyxhQUFhSSxjQUFsQixXQUFvQ0YsRUFBYUcsR0FBakQsV0FDckJILEVBQWFJLFVBQVVDLElBQUlsQixLQUFLTyxrQkFDaENPLEVBQWFLLFlBQWNOLEVBQWFPLGtCQUN4Q04sRUFBYUcsVUFBVUMsSUFBSWxCLEtBQUtTLGFBR3BDWSxnQkFBZ0JSLEdBQ1osTUFBTUMsRUFBZWQsS0FBS1csYUFBYUksY0FBbEIsV0FBb0NGLEVBQWFHLEdBQWpELFdBQ3JCSCxFQUFhSSxVQUFVSyxPQUFPdEIsS0FBS08sa0JBQ25DTyxFQUFhRyxVQUFVSyxPQUFPdEIsS0FBS1MsYUFDbkNLLEVBQWFLLFlBQWMsR0FHL0JJLG9CQUFvQlYsR0FDWEEsRUFBYVcsU0FBU0MsTUFHdkJ6QixLQUFLcUIsZ0JBQWdCUixHQUZyQmIsS0FBS1ksZ0JBQWdCQyxHQU03QmEsbUJBQ0ksT0FBTzFCLEtBQUsyQixXQUFXQyxNQUFNZixJQUFrQkEsRUFBYVcsU0FBU0MsUUFHekVJLHFCQUNRN0IsS0FBSzBCLG9CQUNMMUIsS0FBSzhCLGVBQWViLFVBQVVDLElBQUlsQixLQUFLSyxzQkFDdkNMLEtBQUs4QixlQUFlQyxVQUFXLElBRS9CL0IsS0FBSzhCLGVBQWViLFVBQVVLLE9BQU90QixLQUFLSyxzQkFDMUNMLEtBQUs4QixlQUFlQyxVQUFXLEdBSXZDQyxxQkFDSWhDLEtBQUsyQixXQUFhM0IsS0FBS1csYUFBYXNCLGlCQUFpQmpDLEtBQUtDLGdCQUMxREQsS0FBSzhCLGVBQWlCOUIsS0FBS1csYUFBYUksY0FBY2YsS0FBS0csdUJBQzNESCxLQUFLMkIsV0FBV08sU0FBU3JCLElBQ3JCQSxFQUFhc0IsaUJBQWlCLFNBQVMsS0FDbkNuQyxLQUFLdUIsb0JBQW9CVixHQUN6QmIsS0FBSzZCLDJCQUtqQk8seUJBQ0lwQyxLQUFLMkIsV0FBYVUsTUFBTUMsS0FDcEJ0QyxLQUFLVyxhQUFhc0IsaUJBQWlCakMsS0FBS0MsaUJBRTVDc0MsUUFBUUMsSUFBSXhDLEtBQUsyQixZQUNqQjNCLEtBQUsyQixXQUFXTyxTQUFTckIsSUFDckJiLEtBQUtxQixnQkFBZ0JSLE1BSTdCNEIsaUJBQ0l6QyxLQUFLb0MseUJBQ0xwQyxLQUFLNkIscUJBQ0w3QixLQUFLVyxhQUFhK0IsUUFHdEJDLG1CQUNJM0MsS0FBS1csYUFBYXdCLGlCQUFpQixVQUFXUyxJQUMxQ0EsRUFBSUMsb0JBRVI3QyxLQUFLZ0Msc0Isd0hDN0VFLE1BQU1jLEVBQ2pCakQsWUFDSWtELEVBQU1DLEVBQU1oQyxFQUFJaUMsRUFBU0MsRUFBUUMsRUFBT0MsRUFEakMsR0FLVCxJQUhFLGdCQUFDQyxFQUFELGlCQUFrQkMsRUFBbEIsaUJBQW9DQyxHQUd0Qyw4QkFpQ2tCLEtBQ2hCdkQsS0FBS3dELFNBQVNsQyxTQUNkdEIsS0FBS3dELFNBQVcsUUFuQ2xCLHlCQTBDZ0JDLElBQ2R6RCxLQUFLMEQsT0FBU0QsRUFDZHpELEtBQUsyRCxrQkEzQ0wzRCxLQUFLNEQsTUFBUWIsRUFDYi9DLEtBQUs2RCxNQUFRYixFQUNiaEQsS0FBSzhELGNBQWdCVixFQUNyQnBELEtBQUsrRCxpQkFBbUJWLEVBQ3hCckQsS0FBS2dFLGtCQUFvQlYsRUFDekJ0RCxLQUFLaUUsa0JBQW9CVixFQUN6QnZELEtBQUtrRSxJQUFNbEQsRUFDWGhCLEtBQUttRSxRQUFVakIsRUFDZmxELEtBQUtvRSxTQUFXbkIsRUFDaEJqRCxLQUFLMEQsT0FBU1AsRUFHbEJrQixlQUtJLE9BSm9CQyxTQUNmdkQsY0FBY2YsS0FBSzhELGVBQ25CUyxRQUFReEQsY0FBYyxtQkFDdEJ5RCxXQUFVLEdBSW5CeEMscUJBQ0loQyxLQUFLeUUsY0FBY3RDLGlCQUFpQixTQUFTLElBQ3pDbkMsS0FBS2lFLGtCQUFrQmpFLEtBQUtrRSxPQUVoQ2xFLEtBQUswRSxZQUFZdkMsaUJBQWlCLFNBQVMsSUFDdkNuQyxLQUFLZ0Usa0JBQWtCaEUsS0FBS2tFLE9BRWhDbEUsS0FBSzJFLFdBQVd4QyxpQkFBaUIsU0FBUyxJQUN0Q25DLEtBQUsrRCxpQkFBaUIsQ0FBRWhCLEtBQU0vQyxLQUFLNEQsTUFBT2dCLElBQUs1RSxLQUFLNkQsVUFVNURnQixVQUNRLE9BQU83RSxLQUFLMEQsT0FBTzlCLE1BQU1rRCxHQUFjQSxFQUFVWixNQUFRbEUsS0FBS21FLFVBTXRFUixlQUNRM0QsS0FBSytFLFlBQVk1RCxZQUFjbkIsS0FBSzBELE9BQU9zQixPQUMzQ2hGLEtBQUs2RSxVQUNMN0UsS0FBSzBFLFlBQVl6RCxVQUFVQyxJQUFJLGlDQUUvQmxCLEtBQUswRSxZQUFZekQsVUFBVUssT0FBTyxpQ0FLMUMyRCxlQWVJLE9BZEFqRixLQUFLd0QsU0FBV3hELEtBQUtxRSxlQUNyQnJFLEtBQUsyRSxXQUFhM0UsS0FBS3dELFNBQVN6QyxjQUFjLHlCQUM5Q2YsS0FBS2tGLFVBQVlsRixLQUFLd0QsU0FBU3pDLGNBQWMsMEJBQzdDZixLQUFLK0UsWUFBYy9FLEtBQUt3RCxTQUFTekMsY0FBYywyQkFDL0NmLEtBQUswRSxZQUFjMUUsS0FBS3dELFNBQVN6QyxjQUFjLDJCQUMvQ2YsS0FBS3lFLGNBQWdCekUsS0FBS3dELFNBQVN6QyxjQUFjLDRCQUNqRGYsS0FBS2dDLHFCQUNMaEMsS0FBSzJFLFdBQVdDLElBQU01RSxLQUFLNkQsTUFDM0I3RCxLQUFLMkUsV0FBV1EsSUFBaEIsbUJBQWtDbkYsS0FBSzRELE9BQ3ZDNUQsS0FBS2tGLFVBQVUvRCxZQUFjbkIsS0FBSzRELE1BQ2xDNUQsS0FBSzJELGVBQ0QzRCxLQUFLb0UsV0FBYXBFLEtBQUttRSxVQUN2Qm5FLEtBQUt5RSxjQUFjVyxNQUFNQyxRQUFVLFFBRWhDckYsS0FBS3dELFVDN0ViLE1BQU0xRCxFQUFvQixDQUM3QndGLGFBQWMsZUFDZHBGLGNBQWUsZUFDZkUscUJBQXNCLHNCQUN0QkUsb0JBQXFCLDhCQUNyQkUsZ0JBQWlCLHlCQUNqQkUsV0FBWSx3QkNORCxNQUFNNkUsRUFDakIxRixZQUFZMkYsRyxVQWNPNUMsSUFDQyxXQUFaQSxFQUFJNkMsS0FDSnpGLEtBQUswRixVLEVBaEJZLDBCLHNCQUFBLEssdURBQUEsSyxLQUNyQjFGLEtBQUsyRixjQUFnQnJCLFNBQVN2RCxjQUFjeUUsR0FHaERJLE9BQ0k1RixLQUFLMkYsY0FBYzFFLFVBQVVDLElBQUksZ0JBQ2pDb0QsU0FBU25DLGlCQUFpQixVQUFXbkMsS0FBSzZGLGlCQUc5Q0gsUUFDSTFGLEtBQUsyRixjQUFjMUUsVUFBVUssT0FBTyxnQkFDcENnRCxTQUFTd0Isb0JBQW9CLFVBQVc5RixLQUFLNkYsaUJBU2pERSxvQkFDSS9GLEtBQUsyRixjQUFjeEQsaUJBQWlCLGFBQWNTLEtBRTFDQSxFQUFJb0QsT0FBTy9FLFVBQVVnRixTQUFTLGlCQUM5QnJELEVBQUlvRCxPQUFPL0UsVUFBVWdGLFNBQVMsbUJBRTlCakcsS0FBSzBGLFlDekJOLE1BQU1RLFVBQXNCWCxFQUN2QzFGLFlBQVkyRixFQUFhVyxFQUFrQkMsR0FDdkNDLE1BQU1iLEdBQ054RixLQUFLc0csa0JBQW9CSCxFQUN6Qm5HLEtBQUt1RyxXQUFhdkcsS0FBSzJGLGNBQWM1RSxjQUFjLGdCQUNuRGYsS0FBS3dHLGNBQWdCeEcsS0FBSzJGLGNBQWM1RSxjQUFjLHVCQUN0RGYsS0FBS3lHLGlCQUFtQkwsRUFDeEJwRyxLQUFLMEcsUUFBVXJFLE1BQU1DLEtBQ2pCdEMsS0FBS3VHLFdBQVd0RSxpQkFBaUIsaUJBSXpDMEUsa0JBQ0ksTUFBTUMsRUFBYyxHQUlwQixPQUhBNUcsS0FBSzBHLFFBQVF4RSxTQUFTMkUsSUFDbEJELEVBQVlDLEVBQU05RCxNQUFROEQsRUFBTUMsU0FFN0JGLEVBR1hHLFlBQ0kvRyxLQUFLdUcsV0FBVzdELFFBR3BCc0UscUJBQ0loSCxLQUFLd0csY0FBY00sTUFBUSxZQUUvQkcscUJBQ0lqSCxLQUFLd0csY0FBY00sTUFBUTlHLEtBQUt5RyxpQkFHcENmLFFBQ0lXLE1BQU1YLFFBQ04xRixLQUFLdUcsV0FBVzdELFFBR3BCcUQsb0JBQ0lNLE1BQU1OLG9CQUNOL0YsS0FBS3VHLFdBQVdwRSxpQkFBaUIsVUFBVSxJQUN2Q25DLEtBQUtzRyxrQkFBa0J0RyxLQUFLMkcsc0JDNUJ4QyxNQUFNTyxFQUFhNUMsU0FBU3ZELGNBQWMsNEJBQ3BDb0csRUFBWTdDLFNBQVN2RCxjQUFjLG9CQUNuQ3FHLEVBQWtCOUMsU0FBUytDLGVBQWUsbUJBQzFDQyxFQUFpQmhELFNBQVMrQyxlQUFlLGtCQUN6Q0UsRUFBa0JqRCxTQUFTK0MsZUFBZSxvQkFDMUNHLEVBQVlsRCxTQUFTK0MsZUFBZSxRQUNwQ0ksRUFBV25ELFNBQVMrQyxlQUFlLFNBQ25DSyxFQUFzQnBELFNBQVN2RCxjQUFjLG9CQUU3QzRHLEVBQU0sSUN0QkcsTUFDWDlILFlBQVksR0FBb0IsSUFBcEIsUUFBQytILEVBQVNDLFFBQUFBLEdBQVUsRSxVQUtqQixDQUFDQyxFQUFLRCxJQUNWRSxNQUFNRCxFQUFLRCxHQUFTRyxNQUFNQyxHQUNyQkEsRUFBSUMsR0FDR0QsRUFBSUUsT0FFUkMsUUFBUUMsT0FBUixpQkFBeUJKLEVBQUlLLFksRUFWaEIsdUIsc0JBQUEsSyx1REFBQSxLLEtBQzVCdEksS0FBS3VJLFNBQVdYLEVBQ2hCNUgsS0FBS3dJLFNBQVdYLEVBYXBCWSxjQUNJLE9BQU96SSxLQUFLMEksYUFBTCxVQUFxQjFJLEtBQUt1SSxTQUExQixhQUErQyxDQUNsRFYsUUFBUzdILEtBQUt3SSxXQUl0Qkcsa0JBQ0ksT0FBTzNJLEtBQUswSSxhQUFMLFVBQXFCMUksS0FBS3VJLFNBQTFCLFVBQTRDLENBQy9DVixRQUFTN0gsS0FBS3dJLFdBSXRCSSxXQUFXQyxHQUNQLE9BQU83SSxLQUFLMEksYUFBTCxVQUFxQjFJLEtBQUt1SSxTQUExQixVQUE0QyxDQUMvQ1YsUUFBUzdILEtBQUt3SSxTQUNkTSxPQUFRLE9BQ1JDLEtBQU1DLEtBQUtDLFVBQVVKLEtBSTdCSyxXQUFXQyxHQUNQLE9BQU9uSixLQUFLMEksYUFBTCxVQUFxQjFJLEtBQUt1SSxTQUExQixrQkFBNENZLEdBQVUsQ0FDekR0QixRQUFTN0gsS0FBS3dJLFNBQ2RNLE9BQVEsV0FJaEJNLFlBQVksR0FBZSxJQUFmLEtBQUNyRyxFQUFELE1BQU9zRyxHQUFRLEVBQ3ZCLE9BQU9ySixLQUFLMEksYUFBTCxVQUFxQjFJLEtBQUt1SSxTQUExQixhQUErQyxDQUNsRFYsUUFBUzdILEtBQUt3SSxTQUNkTSxPQUFRLFFBQ1JDLEtBQU1DLEtBQUtDLFVBQVUsQ0FDakJsRyxLQUFNQSxFQUNOc0csTUFBT0EsTUFLbkJDLFdBQVcsR0FBVSxJQUFWLE9BQUNDLEdBQVMsRUFDakIsT0FBT3ZKLEtBQUswSSxhQUFMLFVBQXFCMUksS0FBS3VJLFNBQTFCLG9CQUFzRCxDQUN6RFYsUUFBUzdILEtBQUt3SSxTQUNkTSxPQUFRLFFBQ1JDLEtBQU1DLEtBQUtDLFVBQVUsQ0FDakJNLE9BQVFBLE1BS3BCQyxTQUFTTCxHQUNMLE9BQU9uSixLQUFLMEksYUFBTCxVQUFxQjFJLEtBQUt1SSxTQUExQix3QkFBa0RZLEdBQVUsQ0FDL0R0QixRQUFTN0gsS0FBS3dJLFNBQ2RNLE9BQVEsUUFJaEJXLFdBQVdOLEdBQ1AsT0FBT25KLEtBQUswSSxhQUFMLFVBQXFCMUksS0FBS3VJLFNBQTFCLHdCQUFrRFksR0FBVSxDQUMvRHRCLFFBQVM3SCxLQUFLd0ksU0FDZE0sT0FBUSxhRHBEQSxDQUNoQmxCLFFBQVMsOENBQStDQyxRQUFTLENBQzdENkIsY0FBZSx1Q0FBd0MsZUFBZ0Isc0JBSXpFQyxFQUFXLElFNUJGLE1BQ1g5SixZQUFZLEdBQXFELElBQXJELGlCQUFDK0osRUFBRCxnQkFBbUJDLEVBQW5CLGVBQW9DQyxHQUFpQixFQUM3RDlKLEtBQUsrSixpQkFBbUJ6RixTQUFTdkQsY0FBYzZJLEdBQy9DNUosS0FBS2dLLGdCQUFrQjFGLFNBQVN2RCxjQUFjOEksR0FDOUM3SixLQUFLaUssZUFBaUIzRixTQUFTdkQsY0FBYytJLEdBR2pEckIsY0FDSSxNQUFPLENBQ0gxRixLQUFNL0MsS0FBSytKLGlCQUFpQjVJLFlBQzVCa0ksTUFBT3JKLEtBQUtnSyxnQkFBZ0I3SSxhQUlwQytJLFlBQVksR0FBZSxJQUFmLEtBQUNuSCxFQUFELE1BQU9zRyxHQUFRLEVBQ3ZCckosS0FBSytKLGlCQUFpQjVJLFlBQWM0QixFQUNwQy9DLEtBQUtnSyxnQkFBZ0I3SSxZQUFja0ksRUFHdkNjLFVBQVUsR0FBWSxJQUFaLE9BQUVaLEdBQVUsRUFDbEJ2SixLQUFLaUssZUFBZTdFLE1BQU1nRixnQkFBd0IsY0FBTmIsR0FFL0J2SixLQUFLcUssUUFGZ0MsT0ZRNUIsQ0FDMUJULGlCQUFrQixpQkFBa0JDLGdCQUFpQixpQkFBa0JDLGVBQWdCLHFCQUlyRlEsRUFBWSxJQUFJcEUsRUFBYyxlQW9CcEMsU0FBaUNxRSxHQUM3QkQsRUFBVXRELHFCQUNWVyxFQUNLeUIsWUFBWW1CLEdBQ1p2QyxNQUFNQyxJQUNIMEIsRUFBU08sWUFBWWpDLEdBQ3JCcUMsRUFBVXZELFlBQ1Z1RCxFQUFVNUUsV0FFYjhFLE9BQU9DLElBQ0psSSxRQUFRQyxJQUFSLGlCQUFzQmlJLE9BRXpCQyxTQUFRLFdBaEMyRCxRQUV0RUMsRUFBZSxJQUFJekUsRUFBYyxjQXVEdkMsU0FBaUMwRSxHQUM3QkQsRUFBYTNELHFCQUNiLE1BQU02QixFQUFPLENBQ1Q5RixLQUFNNkgsRUFBV0MsTUFDakI3SCxLQUFNNEgsRUFBVyxlQUVyQmpELEVBQ0tpQixXQUFXQyxHQUNYYixNQUFNQyxJQUNINkMsRUFBU0MsUUFBUTlDLEVBQUlsRixLQUFNa0YsRUFBSWpGLEtBQU1pRixFQUFJL0QsSUFBSytELEVBQUkrQyxNQUFNOUcsSUFBSytELEVBQUk5RSxPQUNqRXdILEVBQWE1RCxZQUNiNEQsRUFBYWpGLFdBRWhCOEUsT0FBT0MsSUFDSmxJLFFBQVFDLElBQVIsaUJBQXNCaUksT0FFekJDLFNBQVEsS0FDTEMsRUFBYTFELDBCQXhFcUQsVUFFeEVnRSxFQUFhLElHbkNKLGNBQTZCMUYsRUFDeEMxRixZQUFZMkYsR0FDUmEsTUFBTWIsR0FDTnhGLEtBQUtrTCxXQUFhbEwsS0FBSzJGLGNBQWM1RSxjQUFjLHdCQUNuRGYsS0FBS21MLGdCQUFrQm5MLEtBQUsyRixjQUFjNUUsY0FBYyx1QkFHNUQ2RSxLQUFLN0MsRUFBTUMsR0FDUHFELE1BQU1ULE9BQ041RixLQUFLa0wsV0FBV3RHLElBQU01QixFQUN0QmhELEtBQUtrTCxXQUFXL0YsSUFBaEIsbUJBQWtDcEMsR0FDbEMvQyxLQUFLbUwsZ0JBQWdCaEssWUFBYzRCLElId0JMLGlCQUVoQ3FJLEVBQWMsSUlyQ2IsY0FBZ0M3RixFQUNuQzFGLFlBQVl3TCxHQUNSaEYsTUFBTWdGLEdBQ05yTCxLQUFLc0wsYUFBZXRMLEtBQUsyRixjQUFjNUUsY0FBYyx1QkFHekR3SyxVQUFVQyxHQUNOeEwsS0FBS3lMLGNBQWdCRCxFQUd6QnpGLG9CQUNJL0YsS0FBSzJGLGNBQWN4RCxpQkFBaUIsVUFBV1MsSUFDM0NBLEVBQUlDLGlCQUNKN0MsS0FBS3lMLG1CQUliekUscUJBQ0loSCxLQUFLc0wsYUFBYXhFLE1BQVEsWUFHOUJHLHFCQUNJakgsS0FBS3NMLGFBQWF4RSxNQUFRLFVKZVEsaUJBRXBDNEUsRUFBb0IsSUFBSXhGLEVBQWMsd0JBcUo1QyxTQUErQnlGLEdBQzNCRCxFQUFrQjFFLHFCQUNsQlcsRUFDSzJCLFdBQVdxQyxHQUNYM0QsTUFBTUMsSUFDSDBCLEVBQVNRLFVBQVVsQyxHQUNuQnlELEVBQWtCM0UsWUFDbEIyRSxFQUFrQmhHLFdBRXJCOEUsT0FBT0MsSUFDSmxJLFFBQVFDLElBQVIsaUJBQXNCaUksT0FFekJDLFNBQVEsS0FDTGdCLEVBQWtCekUsMEJBbEs2RCxRQUUzRnFELEVBQVV2RSxvQkFFVjRFLEVBQWE1RSxvQkFFYmtGLEVBQVdsRixvQkFFWHFGLEVBQVlyRixvQkFFWjJGLEVBQWtCM0Ysb0JBNEJsQm1CLEVBQVcvRSxpQkFBaUIsU0FUNUIsV0FDSW1JLEVBQVUxRSxPQUNWLE1BQU0sS0FBQzdDLEVBQUQsTUFBT3NHLEdBQVNNLEVBQVNsQixjQUMvQm1ELEVBQXlCbkosaUJBQ3pCK0UsRUFBVVYsTUFBUS9ELEVBQ2xCMEUsRUFBU1gsTUFBUXVDLEtBTWQsTUFBTXdDLEVBQTBCLElBQUlqTSxFQUFjRSxFQUFtQndILEdBQzVFdUUsRUFBd0JsSixtQkFFakIsTUFBTWlKLEVBQTJCLElBQUloTSxFQUFjRSxFQUFtQnNILEdBQzdFd0UsRUFBeUJqSixtQkFFbEIsTUFBTW1KLEVBQTRCLElBQUlsTSxFQUFjRSxFQUFtQnlILEdBQzlFdUUsRUFBMEJuSixtQkEyQjFCd0UsRUFBVWhGLGlCQUFpQixTQUozQixXQUNJd0ksRUFBYS9FLE9BQ2JpRyxFQUF3QnBKLG9CQUk1QixNQUFNcUksRUFBVyxJS3JIRixNQUNYakwsWUFBWSxFQUFZa00sR0FBbUIsSUFBL0IsU0FBQ0MsR0FBOEIsRUFDdkNoTSxLQUFLaU0sVUFBWUQsRUFDakJoTSxLQUFLa00sV0FBYTVILFNBQVN2RCxjQUFjZ0wsR0FHN0NoQixRQUFRaEksRUFBTUMsRUFBTWhDLEVBQUlpQyxFQUFTRSxHQUM3QixNQUFNZ0osRUFBT25NLEtBQUtpTSxVQUFVbEosRUFBTUMsRUFBTWhDLEVBQUlpQyxFQUFTRSxHQUNyRG5ELEtBQUtrTSxXQUFXRSxRQUFRRCxHQUc1QkUsWUFBWUMsR0FDUkEsRUFBTXBLLFNBQVNxSyxJQUNYdk0sS0FBSytLLFFBQVF3QixFQUFLeEosS0FBTXdKLEVBQUt2SixLQUFNdUosRUFBS3JJLElBQUtxSSxFQUFLdkIsTUFBTTlHLElBQUtxSSxFQUFLcEosWUx3R2pELENBQ3pCNkksU0FBVSxDQUFDakosRUFBTUMsRUFBTWhDLEVBQUlpQyxFQUFTRSxLQUNoQyxNQUFNZ0osRUFBTyxJQUFJckosRUFBS0MsRUFBTUMsRUFBTWhDLEVBQUlpQyxFQUFTQyxFQUFRQyxFQUFPLFFBQVMsQ0FDbkVFLGdCQUFpQixLQUNiNEgsRUFBV3JGLEtBQUs3QyxFQUFNQyxJQUUxQk8saUJBQW1CdkMsSUFDZm9LLEVBQVl4RixPQUNad0YsRUFBWUcsV0FBVSxLQUNsQkgsRUFBWXBFLHFCQUNaVyxFQUNLdUIsV0FBV2xJLEdBQ1hnSCxNQUFLLEtBQ0ZtRSxFQUFLSyxvQkFDTHBCLEVBQVkxRixXQUVmOEUsT0FBT0MsSUFDSmxJLFFBQVFDLElBQVIsaUJBQXNCaUksT0FFekJDLFNBQVEsS0FDTFUsRUFBWW5FLDRCQUk1QjNELGlCQUFtQnRDLElBQ1FtTCxFQUFLdEgsVUFFeEI4QyxFQUNLOEIsV0FBV3pJLEdBQ1hnSCxNQUFNQyxJQUNIa0UsRUFBS00sZUFBZXhFLEVBQUk5RSxVQUUzQnFILE9BQU9DLElBQ0psSSxRQUFRQyxJQUFSLGlCQUFzQmlJLE9BRzlCOUMsRUFDSzZCLFNBQVN4SSxHQUNUZ0gsTUFBTUMsSUFDSGtFLEVBQUtNLGVBQWV4RSxFQUFJOUUsVUFFM0JxSCxPQUFPQyxJQUNKbEksUUFBUUMsSUFBUixpQkFBc0JpSSxVQUsxQyxPQUFPMEIsRUFBS2xILGlCQUVqQixvQkFHSCxJQUFJL0IsRUFDSmtGLFFBQVFzRSxJQUFJLENBQUMvRSxFQUFJYyxjQUFlZCxFQUFJZ0Isb0JBQy9CWCxNQUFLLElBQTBCLElBQXhCMkQsRUFBVWdCLEdBQWMsRUFDNUJ6SixFQUFTeUksRUFBU3pILElBQ2xCeUYsRUFBU08sWUFBWSxDQUNqQm5ILEtBQU00SSxFQUFTNUksS0FBTXNHLE1BQU9zQyxFQUFTdEMsUUFFekNNLEVBQVNRLFVBQVUsQ0FBQ1osT0FBUW9DLEVBQVNwQyxTQUNyQ3VCLEVBQVN1QixZQUFZTSxFQUFTQyxjQUVyQ3BDLE9BQU9DLElBQ0psSSxRQUFRQyxJQUFSLGlCQUFzQmlJLE9BUzFCL0MsRUFBb0J2RixpQkFBaUIsU0FOckMsV0FDSXVKLEVBQWtCOUYsT0FDbEJrRyxFQUEwQnJKLG9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybXMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRpbmcuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzVmFsaWRhdG9yLCBmb3JtRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5nc1ZhbGlkYXRvci5pbnB1dFNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3NWYWxpZGF0b3Iuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzVmFsaWRhdG9yLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3NWYWxpZGF0b3IuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5nc1ZhbGlkYXRvci5lcnJvckNsYXNzO1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB9O1xyXG5cclxuICAgIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgfTtcclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gICAgfTtcclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIF9oaWRlVmFsaWRhdGlvbk1lc3NhZ2UoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5faW5wdXRMaXN0KVxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgcmVzZXRXaG9sZUZvcm0oKSB7XHJcbiAgICAgICAgdGhpcy5faGlkZVZhbGlkYXRpb25NZXNzYWdlKCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfTtcclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIG5hbWUsIGxpbmssIGlkLCBvd25lcklkLCB1c2VySWQsIGxpa2VzLCBjYXJkU2VsZWN0b3IsXHJcbiAgICAgICAge2hhbmRsZUNhcmRDbGljaywgaGFuZGxlTGlrZUJ1dHRvbiwgaGFuZGxlRGVsZXRlQ2FyZH0sXHJcblxyXG5cclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbiA9IGhhbmRsZUxpa2VCdXR0b247XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgICAgICAgdGhpcy5faWQgPSBpZDtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IG93bmVySWQ7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgICAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2l0ZW1cIilcclxuICAgICAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLl9pZClcclxuICAgICAgICApO1xyXG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24odGhpcy5faWQpXHJcbiAgICAgICAgKTtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIHNyYzogdGhpcy5fbGluayB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ2FyZEZyb21ET00gPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICAgIH07XHJcblxyXG5cclxuICAgIGlzTGlrZWQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlZENhcmQpID0+IGxpa2VkQ2FyZC5faWQgPT09IHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9XHJcbiAgICBoYW5kbGVMaWtlQ2FyZCA9IChhZGRMaWtlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBhZGRMaWtlO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgICB9O1xyXG4gICAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlc0NvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50c19fYnV0dG9uLWhlYXJ0X2FjdGl2ZVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJlbGVtZW50c19fYnV0dG9uLWhlYXJ0X2FjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2dyaWQtaW1hZ2VcIik7XHJcbiAgICAgICAgdGhpcy5fY2FyZE5hbWUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2Rlc2NyaXB0aW9uXCIpO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzQ291bnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2Ftb3VudC1saWtlc1wiKTtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19idXR0b24taGVhcnRcIik7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19idXR0b24tZGVsZXRlXCIpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IGBQaG90byBvZiAke3RoaXMuX25hbWV9YDtcclxuICAgICAgICB0aGlzLl9jYXJkTmFtZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICAgICAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gICAgfVxyXG5cclxufSIsImV4cG9ydCBjb25zdCBzZXR0aW5nc1ZhbGlkYXRvciA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pdGVtXCIsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvbi1zYm10XCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b24tc2JtdF9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pdGVtX3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKG1vZGFsV2luZG93KSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihtb2RhbFdpbmRvdyk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlbmVkXCIpIHx8XHJcbiAgICAgICAgICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19idXR0b25cIilcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKG1vZGFsV2luZG93LCBoYW5kbGVGb3JtU3VibWl0LCBidXR0b25UZXh0VmFsdWUpIHtcclxuICAgICAgICBzdXBlcihtb2RhbFdpbmRvdyk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uU3VibWl0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvbi1zYm10XCIpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvblRleHRWYWx1ZSA9IGJ1dHRvblRleHRWYWx1ZTtcclxuICAgICAgICB0aGlzLl9pbnB1dHMgPSBBcnJheS5mcm9tKFxyXG4gICAgICAgICAgICB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faXRlbVwiKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICAgICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gICAgfVxyXG5cclxuICAgIGZvcm1SZXNldCgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzaG93TWVzc2FnZUxvYWRpbmcoKSB7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uU3VibWl0LnZhbHVlID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH1cclxuICAgIGhpZGVNZXNzYWdlTG9hZGluZygpIHtcclxuICAgICAgICB0aGlzLl9idXR0b25TdWJtaXQudmFsdWUgPSB0aGlzLl9idXR0b25UZXh0VmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSlcclxuICAgICAgICApO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvQ2FyZC5qc1wiXHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvblwiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiXHJcbmltcG9ydCB7XHJcbiAgICBzZXR0aW5nc1ZhbGlkYXRvclxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50c1wiXHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybXNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQge1BvcHVwV2l0aERlbGV0aW5nfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwV2l0aERlbGV0aW5nXCI7XHJcblxyXG5jb25zdCBidXR0b25FZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19idXR0b24tdW51c3VhbFwiKTtcclxuY29uc3QgYnV0dG9uQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19idXR0b25cIik7XHJcbmNvbnN0IGZvcm1FbGVtZW50RWRpdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9ybUVsZW1lbnRFZGl0XCIpO1xyXG5jb25zdCBmb3JtRWxlbWVudEFkZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9ybUVsZW1lbnRBZGRcIik7XHJcbmNvbnN0IGZvcm1FbGVtZW50SW1hZ2U9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZm9ybUVsZW1lbnRJbWFnZVwiKTtcclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYW1lXCIpO1xyXG5jb25zdCBqb2JJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWJvdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZU92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKVxyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIiwgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiY2M4YWIwNTAtYTljMC00YjZmLTk0ZWUtZDIxYTdlMDU5NzRhXCIsIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgfSxcclxufSk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgICB1c2VyTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19oZXJvXCIsIHVzZXJKb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fcm9sZVwiLCBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9fYXZhdGFyXCIsXHJcbn0pO1xyXG5cclxuXHJcbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3BvcHVwLWVkaXRcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQsIFwiU2F2ZVwiKTtcclxuXHJcbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3BvcHVwLWFkZFwiLCBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdCwgXCJDcmVhdGVcIik7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3BvcHVwLXZpZXdlclwiKTtcclxuXHJcbmNvbnN0IGRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aERlbGV0aW5nKFwiI3BvcHVwLWRlbGV0ZVwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVJbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcG9wdXAtcHJvZmlsZS1pbWFnZVwiLCBoYW5kbGVJbWFnZUZvcm1TdWJtaXQsIFwiU2F2ZVwiKTtcclxuXHJcbmVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5kZWxldGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxucHJvZmlsZUltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGRhdGFVc2Vycykge1xyXG4gICAgZWRpdFBvcHVwLnNob3dNZXNzYWdlTG9hZGluZygpO1xyXG4gICAgYXBpXHJcbiAgICAgICAgLmVkaXRQcm9maWxlKGRhdGFVc2VycylcclxuICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICAgICAgICAgIGVkaXRQb3B1cC5mb3JtUmVzZXQoKTtcclxuICAgICAgICAgICAgZWRpdFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG5cclxuICAgICAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEJ1dHRvbigpIHtcclxuICAgIGVkaXRQb3B1cC5vcGVuKCk7XHJcbiAgICBjb25zdCB7bmFtZSwgYWJvdXR9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICAgIGZvcm1FbGVtZW50RWRpdFZhbGlkYXRvci5yZXNldFdob2xlRm9ybSgpO1xyXG4gICAgbmFtZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICAgIGpvYklucHV0LnZhbHVlID0gYWJvdXQ7XHJcblxyXG59XHJcblxyXG5idXR0b25FZGl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVFZGl0QnV0dG9uKTtcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtRWxlbWVudEFkZFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzVmFsaWRhdG9yLCBmb3JtRWxlbWVudEFkZCk7XHJcbmZvcm1FbGVtZW50QWRkVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtRWxlbWVudEVkaXRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5nc1ZhbGlkYXRvciwgZm9ybUVsZW1lbnRFZGl0KTtcclxuZm9ybUVsZW1lbnRFZGl0VmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtRWxlbWVudEltYWdlVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3NWYWxpZGF0b3IsIGZvcm1FbGVtZW50SW1hZ2UpO1xyXG5mb3JtRWxlbWVudEltYWdlVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGRhdGFJbWFnZXMpIHtcclxuICAgIGFkZENhcmRQb3B1cC5zaG93TWVzc2FnZUxvYWRpbmcoKTtcclxuICAgIGNvbnN0IGRhdGEgPSB7XHJcbiAgICAgICAgbmFtZTogZGF0YUltYWdlcy50aXRsZSxcclxuICAgICAgICBsaW5rOiBkYXRhSW1hZ2VzWydpbWFnZS1saW5rJ10sXHJcbiAgICB9O1xyXG4gICAgYXBpXHJcbiAgICAgICAgLmNyZWF0ZUNhcmQoZGF0YSlcclxuICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmRMaXN0LmFkZEl0ZW0ocmVzLm5hbWUsIHJlcy5saW5rLCByZXMuX2lkLCByZXMub3duZXIuX2lkLCByZXMubGlrZXMpO1xyXG4gICAgICAgICAgICBhZGRDYXJkUG9wdXAuZm9ybVJlc2V0KCk7XHJcbiAgICAgICAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgYWRkQ2FyZFBvcHVwLmhpZGVNZXNzYWdlTG9hZGluZygpO1xyXG4gICAgICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRCdXR0b24oKSB7XHJcbiAgICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG4gICAgZm9ybUVsZW1lbnRBZGRWYWxpZGF0b3IucmVzZXRXaG9sZUZvcm0oKTtcclxufVxyXG5idXR0b25BZGQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUFkZEJ1dHRvbik7XHJcblxyXG5jb25zdCBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKHtcclxuICAgIHJlbmRlcmVyOiAobmFtZSwgbGluaywgaWQsIG93bmVySWQsIGxpa2VzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKG5hbWUsIGxpbmssIGlkLCBvd25lcklkLCB1c2VySWQsIGxpa2VzLCBcIiNjYXJkXCIsIHtcclxuICAgICAgICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpbWFnZVBvcHVwLm9wZW4obmFtZSwgbGluayk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGhhbmRsZURlbGV0ZUNhcmQ6IChpZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlUG9wdXAub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlUG9wdXAuc2V0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGVQb3B1cC5zaG93TWVzc2FnZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmRlbGV0ZUNhcmQoaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZEZyb21ET00oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVQb3B1cC5oaWRlTWVzc2FnZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgaGFuZGxlTGlrZUJ1dHRvbjogKGlkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpc0FscmVhZHlMaWtlZCA9IGNhcmQuaXNMaWtlZCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzQWxyZWFkeUxpa2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC51bmxpa2VDYXJkKGlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLmhhbmRsZUxpa2VDYXJkKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5saWtlQ2FyZChpZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZC5oYW5kbGVMaWtlQ2FyZChyZXMubGlrZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKVxyXG4gICAgfVxyXG59LCBcIi5lbGVtZW50c19faXRlbXNcIik7XHJcblxyXG5cclxubGV0IHVzZXJJZDtcclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxyXG4gICAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZERhdGFdKSA9PiB7XHJcbiAgICAgICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICAgICAgbmFtZTogdXNlckRhdGEubmFtZSwgYWJvdXQ6IHVzZXJEYXRhLmFib3V0LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHVzZXJJbmZvLnNldEF2YXRhcih7YXZhdGFyOiB1c2VyRGF0YS5hdmF0YXJ9KTtcclxuICAgICAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhjYXJkRGF0YS5yZXZlcnNlKCkpO1xyXG4gICAgfSlcclxuLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJ9YCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUltYWdlQ2xpY2soKSB7XHJcbiAgICBwcm9maWxlSW1hZ2VQb3B1cC5vcGVuKCk7XHJcbiAgICBmb3JtRWxlbWVudEltYWdlVmFsaWRhdG9yLnJlc2V0V2hvbGVGb3JtKCk7XHJcblxyXG59XHJcblxyXG5wcm9maWxlSW1hZ2VPdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVQcm9maWxlSW1hZ2VDbGljayk7XHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlRm9ybVN1Ym1pdCh1c2VyRGF0YSkge1xyXG4gICAgcHJvZmlsZUltYWdlUG9wdXAuc2hvd01lc3NhZ2VMb2FkaW5nKCk7XHJcbiAgICBhcGlcclxuICAgICAgICAuZWRpdEF2YXRhcih1c2VyRGF0YSlcclxuICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIHVzZXJJbmZvLnNldEF2YXRhcihyZXMpO1xyXG4gICAgICAgICAgICBwcm9maWxlSW1hZ2VQb3B1cC5mb3JtUmVzZXQoKTtcclxuICAgICAgICAgICAgcHJvZmlsZUltYWdlUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJ9YCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHByb2ZpbGVJbWFnZVBvcHVwLmhpZGVNZXNzYWdlTG9hZGluZygpO1xyXG4gICAgICAgIH0pO1xyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKHtiYXNlVXJsLCBoZWFkZXJzfSkge1xyXG4gICAgICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgfVxyXG5cclxuICAgIF9jdXN0b21GZXRjaCA9ICh1cmwsIGhlYWRlcnMpID0+IHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godXJsLCBoZWFkZXJzKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVDYXJkKGRhdGEpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVkaXRQcm9maWxlKHtuYW1lLCBhYm91dH0pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgYWJvdXQ6IGFib3V0LFxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBlZGl0QXZhdGFyKHthdmF0YXJ9KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIGF2YXRhcjogYXZhdGFyLFxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdW5saWtlQ2FyZChjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3Ioe3VzZXJOYW1lU2VsZWN0b3IsIHVzZXJKb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3J9KSB7XHJcbiAgICAgICAgdGhpcy5fdXNlck5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl91c2VySm9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckpvYlNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICBhYm91dDogdGhpcy5fdXNlckpvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyh7bmFtZSwgYWJvdXR9KSB7XHJcbiAgICAgICAgdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICB0aGlzLl91c2VySm9iRWxlbWVudC50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gICAgfVxyXG5cclxuICAgIHNldEF2YXRhcih7IGF2YXRhciB9KSB7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBhdmF0YXJcclxuICAgICAgICAgICAgPyBgdXJsKCR7YXZhdGFyfSlgXHJcbiAgICAgICAgICAgIDogYHVybCgke3RoaXMuX2F2YXRhcn0pYDtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihtb2RhbFdpbmRvdykge1xyXG4gICAgICAgIHN1cGVyKG1vZGFsV2luZG93KTtcclxuICAgICAgICB0aGlzLl9pbWFnZVpvb20gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fdmlld2VyLWltYWdlXCIpO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlWm9vbVRpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3ZpZXdlci10ZXh0XCIpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgICAgICB0aGlzLl9pbWFnZVpvb20uc3JjID0gbGluaztcclxuICAgICAgICB0aGlzLl9pbWFnZVpvb20uYWx0ID0gYFBob3RvIG9mICR7bmFtZX1gO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlWm9vbVRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aERlbGV0aW5nIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0U3VibWl0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvbi1zYm10XCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEFjdGlvbihhY3Rpb24pIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBhY3Rpb247XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd01lc3NhZ2VMb2FkaW5nKCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0U3VibWl0LnZhbHVlID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH1cclxuXHJcbiAgICBoaWRlTWVzc2FnZUxvYWRpbmcoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRTdWJtaXQudmFsdWUgPSBcIlNhdmVkXCI7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHtyZW5kZXJlcn0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRJdGVtKG5hbWUsIGxpbmssIGlkLCBvd25lcklkLCBsaWtlcykge1xyXG4gICAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9yZW5kZXJlcihuYW1lLCBsaW5rLCBpZCwgb3duZXJJZCwgbGlrZXMpO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmFkZEl0ZW0oaXRlbS5uYW1lLCBpdGVtLmxpbmssIGl0ZW0uX2lkLCBpdGVtLm93bmVyLl9pZCwgaXRlbS5saWtlcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNldHRpbmdzVmFsaWRhdG9yIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dExpc3QiLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2J1dHRvbkVsZW1lbnQiLCJkaXNhYmxlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oaWRlVmFsaWRhdGlvbk1lc3NhZ2UiLCJBcnJheSIsImZyb20iLCJjb25zb2xlIiwibG9nIiwicmVzZXRXaG9sZUZvcm0iLCJyZXNldCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIkNhcmQiLCJuYW1lIiwibGluayIsIm93bmVySWQiLCJ1c2VySWQiLCJsaWtlcyIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUxpa2VCdXR0b24iLCJoYW5kbGVEZWxldGVDYXJkIiwiX2VsZW1lbnQiLCJhZGRMaWtlIiwiX2xpa2VzIiwiX3JlbmRlckxpa2VzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9pZCIsIl91c2VySWQiLCJfb3duZXJJZCIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsIl9kZWxldGVCdXR0b24iLCJfbGlrZUJ1dHRvbiIsIl9jYXJkSW1hZ2UiLCJzcmMiLCJpc0xpa2VkIiwibGlrZWRDYXJkIiwiX2xpa2VzQ291bnQiLCJsZW5ndGgiLCJnZW5lcmF0ZUNhcmQiLCJfY2FyZE5hbWUiLCJhbHQiLCJzdHlsZSIsImRpc3BsYXkiLCJmb3JtU2VsZWN0b3IiLCJQb3B1cCIsIm1vZGFsV2luZG93Iiwia2V5IiwiY2xvc2UiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJidXR0b25UZXh0VmFsdWUiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3BvcHVwRm9ybSIsIl9idXR0b25TdWJtaXQiLCJfYnV0dG9uVGV4dFZhbHVlIiwiX2lucHV0cyIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsImZvcm1SZXNldCIsInNob3dNZXNzYWdlTG9hZGluZyIsImhpZGVNZXNzYWdlTG9hZGluZyIsImJ1dHRvbkVkaXQiLCJidXR0b25BZGQiLCJmb3JtRWxlbWVudEVkaXQiLCJnZXRFbGVtZW50QnlJZCIsImZvcm1FbGVtZW50QWRkIiwiZm9ybUVsZW1lbnRJbWFnZSIsIm5hbWVJbnB1dCIsImpvYklucHV0IiwicHJvZmlsZUltYWdlT3ZlcmxheSIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwidXJsIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRVc2VySW5mbyIsIl9jdXN0b21GZXRjaCIsImdldEluaXRpYWxDYXJkcyIsImNyZWF0ZUNhcmQiLCJkYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiZWRpdFByb2ZpbGUiLCJhYm91dCIsImVkaXRBdmF0YXIiLCJhdmF0YXIiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwidXNlckluZm8iLCJ1c2VyTmFtZVNlbGVjdG9yIiwidXNlckpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfdXNlck5hbWVFbGVtZW50IiwiX3VzZXJKb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJzZXRVc2VySW5mbyIsInNldEF2YXRhciIsImJhY2tncm91bmRJbWFnZSIsIl9hdmF0YXIiLCJlZGl0UG9wdXAiLCJkYXRhVXNlcnMiLCJjYXRjaCIsImVyciIsImZpbmFsbHkiLCJhZGRDYXJkUG9wdXAiLCJkYXRhSW1hZ2VzIiwidGl0bGUiLCJjYXJkTGlzdCIsImFkZEl0ZW0iLCJvd25lciIsImltYWdlUG9wdXAiLCJfaW1hZ2Vab29tIiwiX2ltYWdlWm9vbVRpdGxlIiwiZGVsZXRlUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX2lucHV0U3VibWl0Iiwic2V0QWN0aW9uIiwiYWN0aW9uIiwiX2hhbmRsZVN1Ym1pdCIsInByb2ZpbGVJbWFnZVBvcHVwIiwidXNlckRhdGEiLCJmb3JtRWxlbWVudEVkaXRWYWxpZGF0b3IiLCJmb3JtRWxlbWVudEFkZFZhbGlkYXRvciIsImZvcm1FbGVtZW50SW1hZ2VWYWxpZGF0b3IiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImNhcmQiLCJwcmVwZW5kIiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJyZW1vdmVDYXJkRnJvbURPTSIsImhhbmRsZUxpa2VDYXJkIiwiYWxsIiwiY2FyZERhdGEiLCJyZXZlcnNlIl0sInNvdXJjZVJvb3QiOiIifQ==